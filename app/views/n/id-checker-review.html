{% extends 'layout.html' %}


{% set service = "idchecker" %}
{% set signedin = 'true' %}
{% set params = "?demographics=" + demographics + "&role=" + role + "&result=" + result + "&failreason=" + failreason + "&devMode=" + devMode + "&automation=" + automation  %}
{% set dataResult = 'data-result=' + result %}

{% block extrastyles %}
<script src='/panzoom.min.js'></script>
{% endblock %}

{% block content %}



<div class="nhsuk-care-card">

    <!-- -----------------------------JOURNEY TAGS------------------------------------------------------------
         -----------------------------JOURNEY TAGS------------------------------------------------------------
         -----------------------------JOURNEY TAGS------------------------------------------------------------
    -->

    <div class="sticky" >

<!--         {% if data.idv[data.prototype.count].style === 'new' %}
        <div class="nhsuk-care-card__heading-container">
            <h2 class="nhsuk-care-card__heading"><span role="text">Check if we can accept this ID</span></h2>
            <span class="nhsuk-care-card__arrow" aria-hidden="true"></span>
        </div>
        {% endif %} -->

        <!-- is this automated? check for an absence of video file --> 
        {% if data.idv[data.prototype.count].media_video === '' %}
        
        <div class="id-check_automated" >Automated journey</div>
        {% else %}

        <div class="id-check_uplift">Manual journey</div>
    
    
        {% endif %}
     
    </div>
    

    <!--    -----------------------------PHOTO ID CHECK------------------------------------------------------------
            -----------------------------PHOTO ID CHECK------------------------------------------------------------
            -----------------------------PHOTO ID CHECK------------------------------------------------------------            
    -->
    
    {% if data.idv[data.prototype.count].media_video === '' %}
        {% if data.idv[data.prototype.count].paycasso_response_code === 'DeniedSuspectedFraud' %}
        <div style="background-color:#005eb8; color:#ffff; border: 1px solid transparent; {% if data['media_video'] === 'true' %} display:none; {% else %} display:block; {% endif %}">
            <!-- Warning - DeniedSuspectedFraud v2 -->
            <div class="nhsuk-care-card__heading-container ">
                    
                <h5 class="nhsuk-heading-xs">Please ensure:</h5>
                <p>
                <ul class="nhsuk-list-small">
                <li>the expiry date is clearly visible and expired less than 12 months ago (30th January 2020)</li>
                <li>you can clearly read the MRZ or DL number</li>
                <li>the details on the front of the ID match those on the reverse of the ID</li>
                </ul>
                </p>
            </div>
        </div>
            
        {% elif data.idv[data.prototype.count].paycasso_response_code === 'DeniedAgeRequirementNotMetDeniedNotReadableID' %}
        <div style="background-color:#005eb8; color:#ffff; border: 1px solid transparent; {% if data['media_video'] === 'true' %} display:none; {% else %} display:block; {% endif %}">
            <!-- Warning - DeniedAgeRequirementNotMet & DeniedNotReadableID v2 -->
            <div class="nhsuk-care-card__heading-container">
                <h5 class="nhsuk-heading-xs">Please ensure:</h5>
                <p>
                <ul class="nhsuk-list-small">
                <li>the expiry date is clearly visible and expired less than 12 months ago (30th January 2020)</li>
                <li>you can clearly read the MRZ or DL number</li>
                </ul>
                </p>
            </div>
        </div>

        {% elif data.idv[data.prototype.count].paycasso_response_code === 'DeniedDocumentExpired' %}
        <div style="background-color:#005eb8; color:#ffff; border: 1px solid transparent; {% if data['media_video'] === 'true' %} display:none; {% else %} display:block; {% endif %}">
            <!-- Warning - DeniedDocumentExpired v2 -->
            <div class="nhsuk-care-card__heading-container">
                <h5 class="nhsuk-heading-xs">Please ensure:</h5>
                <p>
                <ul class="nhsuk-list-small">
                <li>the ID expired less than 12 months ago (30th January 2020)</li>
                </ul>
                </p>
            </div>
        </div> 

        {% endif %}
    {% endif %}


<!--

$$$$$$$\  $$\   $$\  $$$$$$\ $$$$$$$$\  $$$$$$\         $$$$$$\  $$\   $$\ $$$$$$$$\  $$$$$$\  $$\   $$\
$$  __$$\ $$ |  $$ |$$  __$$\\__$$  __|$$  __$$\       $$  __$$\ $$ |  $$ |$$  _____|$$  __$$\ $$ | $$  |
$$ |  $$ |$$ |  $$ |$$ /  $$ |  $$ |   $$ /  $$ |      $$ /  \__|$$ |  $$ |$$ |      $$ /  \__|$$ |$$  /
$$$$$$$  |$$$$$$$$ |$$ |  $$ |  $$ |   $$ |  $$ |      $$ |      $$$$$$$$ |$$$$$\    $$ |      $$$$$  /
$$  ____/ $$  __$$ |$$ |  $$ |  $$ |   $$ |  $$ |      $$ |      $$  __$$ |$$  __|   $$ |      $$  $$<
$$ |      $$ |  $$ |$$ |  $$ |  $$ |   $$ |  $$ |      $$ |  $$\ $$ |  $$ |$$ |      $$ |  $$\ $$ |\$$\
$$ |      $$ |  $$ | $$$$$$  |  $$ |    $$$$$$  |      \$$$$$$  |$$ |  $$ |$$$$$$$$\ \$$$$$$  |$$ | \$$\
\__|      \__|  \__| \______/   \__|    \______/        \______/ \__|  \__|\________| \______/ \__|  \__|

-->



    <div class="nhsuk-care-card__content">

        <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">
            <h3>Photo ID</h3>
                <p class="nhsuk-body-s idcheck-help">To zoom in either double click on the picture, or position your cursor on the image, then hold 'Alt' + scroll with your mouse wheel. <a href="#" id="reset">Reset</a></p>
                <div class="reading-width panzoom-parent idcheck-image-container">

                    <div class="idcheck-image-expand"><a href="#" class="idcheck-image-expand-button">Expand image</a></div>

                    <div class="idcheck-image zoomable1">
                        <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                             alt="Picture of identity document"/>
                    </div>

                    {% if data.idv[data.prototype.count].media_photoid_back !== '' %}

                    <div class="reading-width idcheck-image-container">
                        <div class="idcheck-image-expand"><a href="#" class="idcheck-image-expand-button">Expand image</a></div>
                        <div class="idcheck-image zoomable2">
                            <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_back}}" class="idcheck-image-img" style="width: 100%;" alt="Image of a driving licence"/>
                        </div>
                    </div>

                    {% endif %}

                </div>
            </div>
            <div class="nhsuk-grid-column-one-half">
                <div class="qa-questions-group" data-complete="false">

                    <div class="qa-questions-question" id="document-1" data-answered="false" data-group="decline-1">

                        <fieldset class="nhsuk-fieldset">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Can you see everything you need to do your identity checks?
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="0" name="a-1" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="0">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer " id="1" name="a-1" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="1">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>
                    </div>



                </div>

                <div class="qa-questions-group" data-complete="false">

                    <div class="qa-questions-question" id="document-2" data-answered="false" data-group="decline-2">


                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Does the photo ID look genuine?
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="2" name="a-2" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="2">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="3" name="a-2" type="radio" value="no" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="3">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>

<!--                    <div id="id-canttell3" class="idcheck-clarity">-->
<!--                        <a href="dashboard" data-target="modal" id="canttellBtn" class="button&#45;&#45;decline&#45;&#45;clarity disabled" style="">I cannot answer this question</a>-->
<!--                    </div>-->
                </div>

                <div class="qa-questions-group" data-complete="false">

                    <div class="qa-questions-question" id="document-3" data-answered="false" data-group="decline-3">


                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Is the photo ID valid?
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="4" name="a-3" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="4">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="5" name="a-3" type="radio" value="no" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="5">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>

                </div>

            </div>
        </div>
    </div>



<!--

$$$$$$$\  $$$$$$$\   $$$$$$\        $$$$$$$$\ $$$$$$$\   $$$$$$\   $$$$$$\  $$$$$$$$\
$$  __$$\ $$  __$$\ $$  __$$\       \__$$  __|$$  __$$\ $$  __$$\ $$  __$$\ $$  _____|
$$ |  $$ |$$ |  $$ |$$ /  \__|         $$ |   $$ |  $$ |$$ /  $$ |$$ /  \__|$$ |
$$$$$$$  |$$ |  $$ |\$$$$$$\           $$ |   $$$$$$$  |$$$$$$$$ |$$ |      $$$$$\
$$  ____/ $$ |  $$ | \____$$\          $$ |   $$  __$$< $$  __$$ |$$ |      $$  __|
$$ |      $$ |  $$ |$$\   $$ |         $$ |   $$ |  $$ |$$ |  $$ |$$ |  $$\ $$ |
$$ |      $$$$$$$  |\$$$$$$  |         $$ |   $$ |  $$ |$$ |  $$ |\$$$$$$  |$$$$$$$$\
\__|      \_______/  \______/          \__|   \__|  \__|\__|  \__| \______/ \________|

-->


<div class="nhsuk-care-card nhsuk-care-card--non-urgent {% if data.idv[data.prototype.count].style === 'old' %}nhsuk-u-margin-top-4{% else %}nhsuk-u-margin-top-0{% endif %} nhsuk-u-margin-bottom-0">

    {% if data.idv[data.prototype.count].style === 'new' %}

    <div class="nhsuk-care-card__heading-container">
        <h2 class="nhsuk-care-card__heading"><span role="text">PDS record</span></h2>
        <span class="nhsuk-care-card__arrow" aria-hidden="true"></span>
    </div>

    {% endif %}
 
    <div class="nhsuk-care-card__content">

        <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">

<!-- ------------------   Post Code  ---------------------------
-----------------------   Post Code  ---------------------------
-----------------------   Post Code  ---------------------------
-->
                <div class="nhsuk-form-group nhsuk-u-margin-bottom-7" >
                        <h3>Postcode</h3>
                        <p style="background-color: #fff9c4; padding: 16px 24px 16px 24px; font-size: 20px; font-weight: bold; width: fit-content;">{{ data.idv[data.prototype.count].postcode}}</p>
                </div>

<!-- ------------------   User information  ---------------------------
-----------------------   User submitted information  ---------------------------
-----------------------   User submitted information  ---------------------------
-->
                {# {% if data.idv[data.prototype.count].pds_match === 'true' %} #}
                {# hide this in the old styles #}
                <details class="nhsuk-details nhsuk-expander nhsuk-u-margin-bottom-7" style= "{% if data['pds_match'] === 'true' %} display:none; {% else %} display:block; {% endif %}">
                    <summary class="nhsuk-details__summary">
                      <span class="nhsuk-details__summary-text">
                      Show user information
                      </span>
                    </summary>

                    <div class="nhsuk-details__text">
                    {# {% endif %} #}


                        <h3>User information</h3>

                        {# if the user knew their NHS number then show it #}
                        {% if data.idv[data.prototype.count].nhs_number !== '' %}

                        <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="nhsnum">
                                NHS Number
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-10" id="nhsnum" value="{{ data.idv[data.prototype.count].nhs_number}}" name="nhsnum" type="text" maxlength="10" readonly>
                        </div>

                        {% endif %}

                        {# if the user entered a first name then show it #}
                        {% if data.idv[data.prototype.count].name_first !== '' %}
                        <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="firstname">
                                First name
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-20" id="firstname" value="{{ data.idv[data.prototype.count].name_first}}" name="firstname" type="text" maxlength="" readonly >
                        </div>
                        {% endif %}

                        {# if the user entered a middle name then show it #}
                        {% if data.idv[data.prototype.count].name_middle !== '' %}                        
                        <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="middlename">
                                Middle names
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-20" id="middlename" value="{{ data.idv[data.prototype.count].name_middle}}" name="middlename" type="text" maxlength="" readonly >
                        </div>
                        {% endif %}

                        {# if the user entered a last name then show it #}
                        {% if data.idv[data.prototype.count].name_last !== '' %}
                        <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="lastname">
                                Last name
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-20" id="lastname" value="{{ data.idv[data.prototype.count].name_last}}" name="lastname" type="text" maxlength="" readonly >
                        </div>
                        {% endif %}

                        {# if the user entered a date of birth then show it #}
                        {% if data.idv[data.prototype.count].date_day !== '' %}
                        {% if data.idv[data.prototype.count].date_month !== '' %}
                        {% if data.idv[data.prototype.count].date_year !== '' %}
                        <div class="nhsuk-form-group">
                            <fieldset class="nhsuk-fieldset" aria-describedby="example-hint" role="group">
                                <legend class="nhsuk-fieldset__legend">
                                    <h3 class="nhsuk-fieldset__legend">
                                        Date of birth
                                    </h3>
                                </legend>
                                <div class="nhsuk-date-input" id="example">
                                    <div class="nhsuk-date-input__item">
                                        <div class="nhsuk-form-group">
                                            <input class="nhsuk-input nhsuk-date-input__input nhsuk-input--width-2" id="example-day" name="example-day" type="number" value="{{ data.idv[data.prototype.count].date_day}}" readonly>
                                        </div>
                                    </div>
                                    <div class="nhsuk-date-input__item">
                                        <div class="nhsuk-form-group">
                                            <input class="nhsuk-input nhsuk-date-input__input nhsuk-input--width-2" id="example-month" name="example-month" type="number" value="{{ data.idv[data.prototype.count].date_month}}" readonly>
                                        </div>
                                    </div>
                                    <div class="nhsuk-date-input__item">
                                        <div class="nhsuk-form-group">
                                            <input class="nhsuk-input nhsuk-date-input__input nhsuk-input--width-4" id="example-year" name="example-year" type="number" value="{{ data.idv[data.prototype.count].date_year}}" readonly>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        {% endif %}
                        {% endif %}
                        {% endif %}
                        
                        {# if the user entered a postcode then show it #}
                        {% if data.idv[data.prototype.count].postcode !== '' %}
                        <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="postcode">
                                Postcode
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-5" id="postcode" value="{{ data.idv[data.prototype.count].postcode}}" name="postcode" type="text" maxlength="" readonly >
                        </div>
                        {% endif %}
                </details>

                
<!-- ------------------   OCR from ID / show for both journies if we have the information  ---------------------------
-----------------------   OCR from ID / show for both journies if we have the information  ---------------------------
-----------------------   OCR from ID / show for both journies if we have the information  ---------------------------
-->

<!-- We have removed this section due to ID Checkers not needing to see OCR scrape when doing an ID Check (only when they do deeper searches but its available on Splunk)-->

<!--                         {# is this automated? check for an absence of video file #}
                        {% if data.idv[data.prototype.count].media_video === '' %}

                        

                    <details class="nhsuk-details nhsuk-expander nhsuk-u-margin-bottom-7" >
                        <summary class="nhsuk-details__summary">
                          <span class="nhsuk-details__summary-text">
                          OCR scrape
                          </span>
                        </summary>
    
                        <div class="nhsuk-details__text">

                            {# {% endif %} #}
    
                            {# is this automated? check for an absence of video file #}
                            {% if data.idv[data.prototype.count].media_video === '' %}
    
                            <h3>Optical character recognition (OCR) from ID</h3>
    
                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="ocrfirstname">
                                    First name
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="ocrfirstname" value="{{ data.idv[data.prototype.count].ocr_name_first}}" name="ocrfirstname" type="text" maxlength="" readonly >
                            </div>
    
                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="ocrmiddlename">
                                    Middle names
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="ocrmiddlename" value="{{ data.idv[data.prototype.count].ocr_name_middle}}" name="ocrmiddlename" type="text" maxlength="" readonly >
                            </div>
    
                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="ocrlastname">
                                    Last name
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="ocrlastname" value="{{ data.idv[data.prototype.count].ocr_name_last}}" name="ocrlastname" type="text" maxlength="" readonly >
                            </div>
    
                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="ocrdob">
                                    Date of birth
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="ocrdob" value="{{ data.idv[data.prototype.count].ocr_dob}}" name="ocrdob" type="text" maxlength="" readonly >
                            </div>
    
                            {% endif %}
    
                            {% endif %}
                    </details> -->



            </div>

<!-- ------------------   PDS Trace Right column  ---------------------------
-----------------------   PDS Trace Right column  ---------------------------
-----------------------   PDS Trace Right column  ---------------------------
-->
            <div class="nhsuk-grid-column-one-half">
                <h3>PDS trace result</h3>

                <div class="bar_container" id="loader">
                    <div id="main_container">
                        <div id="pbar" class="progress-spinner" data-percent="0">
                            <img src="/images/loader-spinner.svg" width="200px" height="200px" id="spinner"/>
                            <div class="ppc-loading">
                                <div class="pcc-percents-wrapper">
                                    <span id="spinner-status">Please wait</span><span aria-hidden="true">...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- PDS RESULT -->


                <div id="trace" class="idcheck-match {% if data['pds_match'] !== 'true' %}  fail{% endif %}" style="display:none;">

                    <div class="idcheck-result">
                        
                        {% if data['pds_match'] === 'true' %} 
                            Single record found
                        {% else %}
                            {% if data.idv[data.prototype.count].pds_failreason === 'expired' %}
                                Match not possible
                            {% elif data.idv[data.prototype.count].pds_failreason === 'invalid' %}
                                System error - SMSP-0001
                            {% elif data.idv[data.prototype.count].pds_failreason === 'validation' %}
                                System error - SMSP-0002
                            {% elif data.idv[data.prototype.count].pds_failreason === 'unavailable' %}
                                System error - SMSP-0003
                            {% else %}
                                Match not found
                            {% endif %}
                        {% endif %}
                    </div>



                    {% if data.idv[data.prototype.count].pds_matches === 'false' %}

                        {% if data.idv[data.prototype.count].pds_failreason === 'multiple' %}
                        <div class="idcheck-result-reason" id="failed">
                            <p>Multiple results were returned</p>
                        </div>
                        {% elif data.idv[data.prototype.count].pds_failreason === 'invalid' %}
                        <div class="idcheck-result-reason" id="failed">
                            <!--<p>The submitted NHS number is invalid</p>-->
                        </div>
                        {% elif data.idv[data.prototype.count].pds_failreason === 'expired' %}
                        <div class="idcheck-result-reason" id="failed">
                            <p>The record for this NHS number contains a date of death.</p>
                        </div>
                        {% else %}
                        <div class="idcheck-result-reason" id="failed">
                            <!--<p>Either the NHS number is invalid or it does not match to the date of birth submitted.</p>-->
                        </div>
                        {% endif %}

                    {% endif %}


                    {% if data.idv[data.prototype.count].pds_matches === 'spine' %}

                        {% if data.idv[data.prototype.count].pds_failreason === 'invalid' %}
                        <div class="idcheck-result-reason" id="failed">
                            <p>Please contact your supervisor.</p>
                        </div>

                        {% elif data.idv[data.prototype.count].pds_failreason === 'validation' %}
                        <div class="idcheck-result-reason" id="failed">
                            <p>Please contact your supervisor.</p>
                        </div>

                        {% elif data.idv[data.prototype.count].pds_failreason === 'unavailable' %}
                        <div class="idcheck-result-reason" id="failed">
                            <p>We are having technical problems.</p>
                            <p>Please abort and try again later.</p>
                        </div>

                        {% else %}
                        <div class="idcheck-result-reason" id="failed">
                            <p>We are having technical problems.</p>
                            <p>Please abort and try again later.</p>
                        </div>
                        {% endif %}

                    {% endif %}

                </div> 

                <div id="retrace" class="idcheck-match" style="display:none;">
                    <div class="idcheck-result">
                            Single record found
                    </div>
                </div>

                {% if data.idv[data.prototype.count].pds_matches === 'false' %}

                <div class="form-group nhsuk-u-margin-top-4" id="declinebtn-2" style="display: none;">

                    {% if data.idv[data.prototype.count].pds_failreason === 'expired' %}

                    <div id="id-decline3">
                        <a href="dashboard" data-target="modal" id="declineBtn3" class="button button--decline">Decline</a>
                    </div>

                    {% else %}

                    <div class="qa-questions-group" data-complete="false" style=" {% if data['pds_match'] === 'true' %} display:none; {% else %} display:block; {% endif %}">
                        <div class="qa-questions-question" id="trace-1" data-answered="false" data-group="decline-4a">

                            <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-4">

                                <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                    <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                        <br class="nhsuk-fieldset__heading">
                                            Can you find a single, matching PDS record?
                                        </h3>
                                    </legend>
                                </div>

                                <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                    <div class="nhsuk-radios nhsuk-radios--inline">

                                        <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                            <input class="nhsuk-radios__input qa-questions-answer" id="6" name="a-4a" type="radio" value="yes" aria-checked="false" aria-controls="nhs-yes">
                                            <label class="nhsuk-label nhsuk-radios__label" for="6">
                                                Yes
                                            </label>
                                        </div>

                                        <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3" data-target="" >
                                            <input class="nhsuk-radios__input qa-questions-answer" id="7" name="a-4a" type="radio" value="no" aria-checked="false" aria-controls="nhs-no">
                                            <label class="nhsuk-label nhsuk-radios__label" for="7">
                                                No
                                            </label>
                                        </div>

                                    </div>

                                </div>

                            </fieldset>

                        </div>

                    </div>


                    <div aria-hidden="true" aria-expanded="false" class="js-hidden nhsuk-u-margin-top-3" id="nhs-yes" data-group="decline-4a">

                        <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="nhs_number">
                                NHS number
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-10" id="nhs_number" value="" name="nhs_number" type="text" maxlength="" >
                        </div>

{#                         <div class="nhsuk-form-group">
                            <label class="nhsuk-label" for="postcode">
                                Current postcode (from PDS)
                            </label>
                            <input class="nhsuk-input nhsuk-input--width-5" id="postcode" value="" name="postcode" type="text" maxlength="" >
                        </div> #}

                        <div id="id-approve2">
                            <button id="retraceBtn" data-target="" class="nhsuk-button button--retry">Re-run trace</button>
                        </div>
                    </div>

                    <div aria-hidden="true" aria-expanded="false" class="js-hidden nhsuk-u-margin-top-3" id="nhs-no" data-group="decline-0">
                        <div id="id-decline2">
                            <a href="dashboard" id="declineBtn2" data-target="modal" class="nhsuk-button button--decline">Decline</a>
                        </div>
                    </div>

                {% endif %}

                </div>

                {% endif %}

                {% if data.idv[data.prototype.count].pds_matches === 'spine' %}
                <div id="retrybtn-1" style="display:none;">
                    <div id="id-retry">
                        <a href="id-checker-review"
                           id="retryBtn" class="button button--retry">Retry</a>
                    </div>
                </div>
                {% endif %}

            </div>
        </div>
    </div>
</div>


<!--

$$$$$$$\  $$$$$$$\   $$$$$$\         $$$$$$\  $$\   $$\ $$$$$$$$\  $$$$$$\  $$\   $$\
$$  __$$\ $$  __$$\ $$  __$$\       $$  __$$\ $$ |  $$ |$$  _____|$$  __$$\ $$ | $$  |
$$ |  $$ |$$ |  $$ |$$ /  \__|      $$ /  \__|$$ |  $$ |$$ |      $$ /  \__|$$ |$$  /
$$$$$$$  |$$ |  $$ |\$$$$$$\        $$ |      $$$$$$$$ |$$$$$\    $$ |      $$$$$  /
$$  ____/ $$ |  $$ | \____$$\       $$ |      $$  __$$ |$$  __|   $$ |      $$  $$<
$$ |      $$ |  $$ |$$\   $$ |      $$ |  $$\ $$ |  $$ |$$ |      $$ |  $$\ $$ |\$$\
$$ |      $$$$$$$  |\$$$$$$  |      \$$$$$$  |$$ |  $$ |$$$$$$$$\ \$$$$$$  |$$ | \$$\
\__|      \_______/  \______/        \______/ \__|  \__|\________| \______/ \__|  \__|

-->


<div class="nhsuk-care-card nhsuk-care-card--non-urgent {% if data.idv[data.prototype.count].style === 'old' %}nhsuk-u-margin-top-4{% else %}nhsuk-u-margin-top-0{% endif %} nhsuk-u-margin-bottom-0">

    {% if data.idv[data.prototype.count].style === 'new' %}

    <div class="nhsuk-care-card__heading-container">
        <h2 class="nhsuk-care-card__heading"><span role="text">PDS record</span></h2>
        <span class="nhsuk-care-card__arrow" aria-hidden="true"></span>
    </div>

    {% endif %}

    <div class="nhsuk-care-card__content">

        <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">

                {% if data.idv[data.prototype.count].style === 'old' %}
                <h3>Compare the photo ID and the PDS record</h3>
                {% endif %}

                <div class="reading-width idcheck-image-container">
<!--                    <div class="idcheck-image-expand"><a href="#" class="idcheck-image-expand-button">Expand image</a></div>-->

                    <div class="idcheck-image zoomable3">

                        <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                             alt="Picture of a identity document"/>

                    </div>

                </div>

            </div>
            <div class="nhsuk-grid-column-one-half">
                <h3>PDS record</h3>

                <div class="idcheck-match">

                    <table id="pds-result">
                        <tr>
                            <td>First name:</td>
                            <td><b>{% if data.idv[data.prototype.count].pds_matches === 'true' %}{{ data.idv[data.prototype.count].pds_name_first }}{% else %}-{% endif %}</b></td>
                        </tr>
                        <tr>
                            <td>Middle name:</td>
                            <td><b>{% if data.idv[data.prototype.count].pds_matches === 'true' %}{{ data.idv[data.prototype.count].pds_name_middle }}{% else %}-{% endif %}</b></td>
                        </tr>
                        <tr>
                            <td>Last name:</td>
                            <td><b>{% if data.idv[data.prototype.count].pds_matches === 'true' %}{{ data.idv[data.prototype.count].pds_name_last }}{% else %}-{% endif %}</b></td>
                        </tr>
                        <tr>
                            <td>Date of birth:</td>
                            <td><b>{% if data.idv[data.prototype.count].pds_matches === 'true' %}{{ data.idv[data.prototype.count].pds_name_dob }}{% else %}-{% endif %}</b></td>
                        </tr>
                    </table>

                    {# results shown after a re-trace #}
                    <table id="pds-retrace-result" style="display: none;">
                        <tr>
                            <td>First name:</td>
                            <td><b>{{ data.idv[data.prototype.count].pds_name_first }}</b></td>
                        </tr>
                        <tr>
                            <td>Middle name:</td>
                            <td><b>{{ data.idv[data.prototype.count].pds_name_middle }}</b></td>
                        </tr>
                        <tr>
                            <td>Last name:</td>
                            <td><b>{{ data.idv[data.prototype.count].pds_name_last }}</b></td>
                        </tr>
                        <tr>
                            <td>Date of birth:</td>
                            <td><b>{{ data.idv[data.prototype.count].pds_name_dob }}</b></td>
                        </tr>
                    </table>

                </div>


                <div class="qa-questions-group" data-complete="false">

                    <div class="qa-questions-question" id="pds-1" data-answered="false" data-group="decline-4a">

                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Do the dates of birth match?
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="8" name="a-4" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="8">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="9" name="a-4" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="9">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>

                </div>


                <div class="qa-questions-group" data-complete="false">

                    <div class="qa-questions-question" id="pds-2" data-answered="false" data-group="decline-4b">

                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Do the first names match?
                                    </h3>
                                </legend>
                            </div>


                            <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="10" name="a-5" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="10">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="11" name="a-5" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="11">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>

                    <div class="callout callout--info" style="display: none" id="manual-pds-1">

                        <div class="nhsuk-form-group nhsuk-u-margin-bottom-0">

                            <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-0">

                                <p style="">Use DSA to check the PDS record. Do any historic first names match the first name on the photo ID?</p>

                                <div class="nhsuk-radios nhsuk-radios--inline">
                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="radio-inline-3" name="radio-inline-group-1" type="radio" value="yes" aria-checked="false" aria-controls="pds-yes-1">
                                        <label class="nhsuk-label nhsuk-radios__label" for="radio-inline-3">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3" data-target="" data-group="decline-4b">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="radio-inline-4" name="radio-inline-group-1" type="radio" value="no" aria-checked="false" aria-controls="pds-no-1">
                                        <label class="nhsuk-label nhsuk-radios__label" for="radio-inline-4">
                                            No
                                        </label>
                                    </div>
                                </div>
                            </fieldset>

                        </div>

                        <div aria-hidden="true" aria-expanded="false" class="js-hidden nhsuk-u-margin-top-3" id="pds-no-1" data-group="decline-4b">
                            <div id="id-decline2">
                                <a href="dashboard" id="declineBtn2" data-target="modal" class="nhsuk-button button--modal button--decline nhsuk-u-margin-bottom-0">Decline</a>
                            </div>
                        </div>

                    </div>

                </div>

                <div class="qa-questions-group" data-complete="false">


                    <div class="qa-questions-question" id="pds-3" data-answered="false" data-group="decline-4c">

                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Do the last names match?
                                    </h3>
                                </legend>
                            </div>


                            <div class="qa-questions-answer-group multiple-choice__container" data-answered="false">

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="12" name="a-6" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="12">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="13" name="a-6" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="13">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>

                    <div class="callout callout--info" style="display: none" id="manual-pds-2">

                        <div class="nhsuk-form-group nhsuk-u-margin-bottom-0">

                            <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-0">

                                <p style="">Use DSA to check the PDS record. Do any historic last names match the last name on their photo ID?</p>

                                <div class="nhsuk-radios nhsuk-radios--inline">
                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="radio-inline-5" name="radio-inline-group-2" type="radio" value="yes" aria-checked="false" aria-controls="pds-yes-2">
                                        <label class="nhsuk-label nhsuk-radios__label" for="radio-inline-5">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3" data-target="" data-group="decline-4c">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="radio-inline-6" name="radio-inline-group-2" type="radio" value="no" aria-checked="false" aria-controls="pds-no-2">
                                        <label class="nhsuk-label nhsuk-radios__label" for="radio-inline-6">
                                            No
                                        </label>
                                    </div>
                                </div>
                            </fieldset>

                        </div>

                        <div aria-hidden="true" aria-expanded="false" class="js-hidden nhsuk-u-margin-top-3" id="pds-no-2" data-group="decline-4c">
                            <div id="id-decline2">
                                <a href="dashboard" id="declineBtn2" data-target="modal" class="nhsuk-button button--modal button--decline nhsuk-u-margin-bottom-0">Decline</a>
                            </div>
                        </div>




                    </div>  

                </div>

            </div>
        </div>
    </div>
</div>

<!--

$$\       $$$$$$\ $$\   $$\ $$$$$$$$\ $$\   $$\ $$$$$$$$\  $$$$$$\   $$$$$$\              $$\       $$\       $$$$$$\ $$\    $$\ $$$$$$$$\ $$\   $$\ $$$$$$$$\  $$$$$$\   $$$$$$\
$$ |      \_$$  _|$$ | $$  |$$  _____|$$$\  $$ |$$  _____|$$  __$$\ $$  __$$\            $$  |      $$ |      \_$$  _|$$ |   $$ |$$  _____|$$$\  $$ |$$  _____|$$  __$$\ $$  __$$\
$$ |        $$ |  $$ |$$  / $$ |      $$$$\ $$ |$$ |      $$ /  \__|$$ /  \__|          $$  /       $$ |        $$ |  $$ |   $$ |$$ |      $$$$\ $$ |$$ |      $$ /  \__|$$ /  \__|
$$ |        $$ |  $$$$$  /  $$$$$\    $$ $$\$$ |$$$$$\    \$$$$$$\  \$$$$$$\           $$  /        $$ |        $$ |  \$$\  $$  |$$$$$\    $$ $$\$$ |$$$$$\    \$$$$$$\  \$$$$$$\
$$ |        $$ |  $$  $$<   $$  __|   $$ \$$$$ |$$  __|    \____$$\  \____$$\         $$  /         $$ |        $$ |   \$$\$$  / $$  __|   $$ \$$$$ |$$  __|    \____$$\  \____$$\
$$ |        $$ |  $$ |\$$\  $$ |      $$ |\$$$ |$$ |      $$\   $$ |$$\   $$ |       $$  /          $$ |        $$ |    \$$$  /  $$ |      $$ |\$$$ |$$ |      $$\   $$ |$$\   $$ |
$$$$$$$$\ $$$$$$\ $$ | \$$\ $$$$$$$$\ $$ | \$$ |$$$$$$$$\ \$$$$$$  |\$$$$$$  |      $$  /           $$$$$$$$\ $$$$$$\    \$  /   $$$$$$$$\ $$ | \$$ |$$$$$$$$\ \$$$$$$  |\$$$$$$  |
\________|\______|\__|  \__|\________|\__|  \__|\________| \______/  \______/       \__/            \________|\______|    \_/    \________|\__|  \__|\________| \______/  \______/

-->

<div class="nhsuk-care-card nhsuk-care-card--non-urgent {% if data.idv[data.prototype.count].style === 'old' %}nhsuk-u-margin-top-4{% else %}nhsuk-u-margin-top-0{% endif %} nhsuk-u-margin-bottom-0">

    {% if data.idv[data.prototype.count].style === 'new' %}

    <div class="nhsuk-care-card__heading-container">
        <h2 class="nhsuk-care-card__heading"><span role="text">PDS record</span></h2>
        <span class="nhsuk-care-card__arrow" aria-hidden="true"></span>
    </div>

    {% endif %}

    <div class="nhsuk-care-card__content">

        <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">
                {% if data.idv[data.prototype.count].media_video === '' %}
                    <h3>Image from face scan</h3>
                {% else %}
                    <h3>Video selfie</h3>
                {% endif %}
                <div class="idcheck-media">
                    <div class="idcheck-video">

                        <div class="idcheck-video-paired"><a href="#" class="idcheck-video-paired-button"><u>Show ID</u></a></div>

                        <div class="idcheck-video-number">{{data.idv[data.prototype.count].challenge }}</div>

                        {% if data.idv[data.prototype.count].media_video === '' %}
                        <img src="/images/media/scans/{{ data.idv[data.prototype.count].media_scan }}" class="idcheck-image-img" style="width: 100%; height: auto;"
                             alt="Image of the user from iproov"/>
                        {% else %}
                        <video id="uploaded-video" controls autoplay="" name="media" style="width:100%;height:auto;">
                            <source src="/images/media/videos/{{ data.idv[data.prototype.count].media_video }}" type="video/mp4">
                            <p>Your browser doesn't support Apple's HEVC videos yet. Here is
                                a <a href="hevc.mkv">link to the video</a> instead.</p>
                        </video>
                        {% endif %}
                    </div>

                    <div class="idcheck-divider">&nbsp;</div>

                    <div class="idcheck-image-container idcheck-photoid" style="display: none;">

                        <div class="idcheck-image zoomable4" >

                            <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                                 alt="Picture of an identity document"/>

                        </div>

                    </div>

                </div>
                <br>
                                
            {% if data.idv[data.prototype.count].media_video === '' %}
            {% else %}


                <div class="nhsuk-transcodedvideo-link">
                    <a class="nhsuk-transcodedvideo-link__link" href="#">
                        <img src="/images/transcodedvideo.svg" class="nhsuk-icon__arrow-right-circle">
                        <span class="nhsuk-transcodedvideo-link__text" style="font-size:14px; vertical-align:middle" id="transcodelink">Show the original video</span>
                    </a>
                </div>
            
{#             <p class="nhsuk-body-s idcheck-help"><a href="#">Play the other video.</p></a>
 #}

{#             <p class="nhsuk-body-s idcheck-help">If you are unable to play the video, <a href="#">try playing this one instead</a>.</p>
 #}
            {% endif %}
            </div>
            <div class="nhsuk-grid-column-one-half">
                <div class="qa-questions-group" data-complete="false">
                    <div class="qa-questions-question" id="selfie-1" data-answered="false" data-group="decline-5">

                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        {% if data.idv[data.prototype.count].media_video === '' %}
                                            Do the faces from the face scan and the photo ID match?
                                        {% else %}
                                            Can you clearly see the face in the video?
                                        {% endif %}
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" {% if data.idv[data.prototype.count].media_video === '' %} data-answered="true"{% else %} data-answered="false" {% endif %}>

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="14" name="a-7" type="radio" value="yes" {% if data.idv[data.prototype.count].media_video === '' %}aria-checked="true" checked="checked"{% else %} aria-checked="false" {% endif %}>
                                        <label class="nhsuk-label nhsuk-radios__label" for="14">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="15" name="a-7" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="15">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>
                </div>

                <!-- hide this question in automation -->

                <div class="qa-questions-group {% if data.idv[data.prototype.count].media_video === '' %}js-hidden" data-complete="true"{% else %}" data-complete="true"{% endif %}>
                    <div class="qa-questions-question" id="selfie-2" {% if data.idv[data.prototype.count].media_video === '' %}data-answered="true"{% else %}data-answered="false"{% endif %} data-group="decline-6">

                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                            Does the face in the photo ID match the face in the video?
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" {% if data.idv[data.prototype.count].media_video === '' %} data-answered="true"{% else %} data-answered="false" {% endif %}>

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="16" name="a-8" type="radio" value="yes" {% if data.idv[data.prototype.count].media_video === '' %}aria-checked="true" checked="checked"{% else %} aria-checked="false" {% endif %}>
                                        <label class="nhsuk-label nhsuk-radios__label" for="16">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="17" name="a-8" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="17">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div>

                </div>

                <!-- hide this question in automation -->

                <div class="qa-questions-group {% if data.idv[data.prototype.count].media_video === '' %}js-hidden" data-complete="true"{% else %}" data-complete="true"{% endif %}>
                    <div class="qa-questions-question" id="selfie-3" {% if data.idv[data.prototype.count].media_video === '' %}data-answered="true"{% else %}data-answered="false"{% endif %} data-group="decline-7">

                        <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-6">

                            <div class="qa-questions-question-text nhsuk-u-padding-bottom-2">
                                <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                                    <h3 class="nhsuk-fieldset__heading">
                                        Can you clearly see or hear {{data.idv[data.prototype.count].challenge }}?
                                    </h3>
                                </legend>
                            </div>

                            <div class="qa-questions-answer-group multiple-choice__container" {% if data.idv[data.prototype.count].media_video === '' %} data-answered="true"{% else %} data-answered="false" {% endif %}>

                                <div class="nhsuk-radios nhsuk-radios--inline">

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="19" name="a-9" type="radio" value="yes" {% if data.idv[data.prototype.count].media_video === '' %}aria-checked="true" checked="checked"{% else %} aria-checked="false" {% endif %}>
                                        <label class="nhsuk-label nhsuk-radios__label" for="19">
                                            Yes
                                        </label>
                                    </div>

                                    <div class="nhsuk-radios__item nhsuk-u-margin-bottom-3">
                                        <input class="nhsuk-radios__input qa-questions-answer" id="20" name="a-9" type="radio" value="yes" aria-checked="false">
                                        <label class="nhsuk-label nhsuk-radios__label" for="20">
                                            No
                                        </label>
                                    </div>

                                </div>

                            </div>

                        </fieldset>

                    </div> 
                </div>

                <div id="id-buttons"> 
                    <div id="id-approve">
                        <a href="dashboard" data-target="modal" id="approveBtn" class="nhsuk-button button---approve button--modal nhsuk-u-margin-top-3" style="display: none;">Continue to approve
                        </a>  
                    </div>
                    <div id="id-decline">
                        <a href="dashboard" data-target="modal" id="declineBtn" class="nhsuk-button button--decline button--modal nhsuk-u-margin-top-3" style="display: none;">Decline</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 

<div id="slideout" data-status="closed">
    <a href="dashboard" data-target="modal" id="slideout__button"class="button--modal">
        <img src="/images/problem.png" alt="Feedback" height="173" width="32" />
    </a>
</div>

<div id="slideout-value" style="visibility: hidden">
    <div id="slideout-value_tab">
        <p>Comparison<br>Score</p>
        <div id="slideout-value_tab_spinner">&nbsp</div>
        <div id="slideout-value_tab_value" style="display: none;">98.85%</div>
    </div>
    <div id="slideout-value_inner">
        <h3 class="slideout-title">Photo ID information</h3>
        <table class="slideout-table">
            <tr>
                <td>Confidence score</td>
                <td>99.2%</td>
            </tr>
            <tr>
                <td>Brightness: </td>
                <td>73.9993</td>
            </tr>
            <tr>
                <td>Sharpness: </td>
                <td>97.466</td>
            </tr>
            <tr>
                <td>Glasses: </td>
                <td>No</td>
            </tr>
            <tr>
                <td>Gender: </td>
                <td>Male (99%)</td>
            </tr>
        </table>

        <h3 class="slideout-title">Video information</h3>
        <table class="slideout-table">
            <tr>
                <td>Confidence score</td>
                <td>99.2%</td>
            </tr>
            <tr>
                <td>Brightness: </td>
                <td>73.9993</td>
            </tr>
            <tr>
                <td>Sharpness: </td>
                <td>97.466</td>
            </tr>
            <tr>
                <td>Glasses: </td>
                <td>No</td>
            </tr>
            <tr>
                <td>Gender: </td>
                <td>Male (99%)</td>
            </tr>
        </table>

    </div>
</div>






<!-- MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW 
    MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW 
    MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW MODAL WINDOW 
    --------------->


<div class="modal-overlay" id="modal_window" aria-hidden="true" role="dialog" aria-labelledby="modal_title">
    <div class="modal-content" id="modal_holder" role="document" >
        <label class="nhsuk-label" for="sort">
            <h3 id="modal-header"></h3>
        </label>


        <!-- APPROVE MODALLLLL 
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        ---------------->

        <div class="first-item" id="approve-modal" style="display:none">
            <form action="accept" method="POST" role="form">

                    <div class="nhsuk-form-group" >
                  
                        <fieldset class="nhsuk-fieldset" aria-describedby="example-hint">
                  
                            <div class="nhsuk-checkboxes">
                    
                                <div class="nhsuk-checkboxes__item">
                                    <input class="nhsuk-checkboxes__input" onclick="setTimeout(conFirm, 500);" id="confirm" name="example" type="checkbox" value="">
                                    <label class="nhsuk-label nhsuk-checkboxes__label" for="example-1">
                                        Yes, I confirm it has passed all checks 
                                    </label>
                                </div>
                            </div>
                        </fieldset>
                    </div> 

                    <div class="form-group nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0" >
                        <button action="modal-link" method="POST" class="nhsuk-button full-width nhsuk-u-margin-bottom-3 button--approve-modal nhsuk-u-margin-top-0"  id="modal-link" style="transition-duration: 500ms; transition-timing-function: ease;  width:100%;" 
                            href="javascript{}:" onclick="document.getElementById('modal-link').submit(); return false;" disabled="disabled">Approve</button>
                    </div>
                    <div class="form-group nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0" >
                        <p class="nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-3 nhsuk-u-margin-left-3" style="display:inline-block;"><a  href="#" onclick="closeOverlay()" class="cancel" id="modal_close2">Cancel</a></p>
                    </div>
            </form>
        </div>



        <!-- DECLINE MODALLLLL 
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        ---------------->


        <div class="first-item" id="decline-modal" style="display:none"> 
            <form action="reject" method="POST" role="form">

                

                <div class="nhsuk-form-group">

                    <div id="modal-clarity" style="display:none;">

                        <div class="nhsuk-grid-row">
                            <div class="nhsuk-grid-column-two-thirds">
<!--                                <div class="idcheck-image" style="margin-top:0;">-->
<!--                                    <img src="/images/passport_redacted.jpg" class="idcheck-image-img" style="width: 100%;"-->
<!--                                         alt="Image of a passport"/>-->
<!--                                </div>-->

                                <div class="idcheck-image-container panzoom-parent">

                                    <div class="idcheck-image zoomable5">

                                        <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                                             alt="Picture of an identity document"/>

                                    </div>

                                </div>
                            </div>

                            <div class="nhsuk-grid-column-one-third nhsuk-u-margin-top-0">

                                <div class="nhsuk-form-group">

                                    <fieldset class="nhsuk-fieldset">

                                        <div class="nhsuk-checkboxes nhsuk-checkboxes--small">

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0 ">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-1" name="example-hint" type="checkbox" value="blur">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-1">
                                                    It's too blurred
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-2" name="example-hint" type="checkbox" value="glare">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-2">
                                                    There's too much glare
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0" id="idcheck-clarity-hologram" style="display:none;">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-holo" name="example-hint" type="checkbox" value="glare">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-holo">
                                                    The hologram is hiding some information
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-3" name="example-hint" type="checkbox" value="light">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-3">
                                                    It's too light (overexposed)
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-4" name="example-hint" type="checkbox" value="dark">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-4">
                                                    It's too dark
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-5" name="example-hint" type="checkbox" value="cropped">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-5">
                                                    It's cropped (part of the document is not in the photo)
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-6" name="example-hint" type="checkbox" value="covered">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-6">
                                                    Something is covering some or all of the document
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-7" name="example-hint" type="checkbox" value="small">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-7">
                                                    It's too small
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-8" name="example-hint" type="checkbox" value="dirty">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-8">
                                                    It's too dirty
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-9" name="example-hint" type="checkbox" value="filtered">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-9">
                                                    A photo filter has been applied
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-10" name="example-hint" type="checkbox" value="other" data-question="decline-text-16">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-10">
                                                    Other
                                                </label>
                                            </div>

                                        </div>
                                    </fieldset>

                                </div>

                            </div>
                        </div>
                    </div>



                    <div id="rejection-reasons">

                        <select id="decline-0" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-010" data-question="">--- Please select ---</option>

                            <option value="IDC-011" data-question="decline-text-2a">No record found</option>
                            <option value="IDC-012" data-question="decline-text-2b">Duplicate live records found</option>
                            <option value="IDC-013" data-question="decline-text-2b">Confusion record</option>
                            <option value="IDC-014" data-question="decline-text-2a">PDS issue with record</option>
                            <option value="IDC-015" data-question="decline-text-2a">Date of birth does not match</option>
                            <option value="IDC-016" data-question="decline-text-2a">Postcodes do not match</option>


                        </select>


                        <select id="decline-1" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-023" data-question="">--- Please select ---</option>
                            {# <option value="IDC-024" data-question="none">User has not sent any ID at all</option> #}
                            {# <option value="IDC-025" data-question="none">It is not a type of ID we accept</option> #}
                            <option value="IDC-026" data-question="decline-text-1">Driving licence - cannot see everything clearly</option>
                            <option value="IDC-027" data-question="decline-text-1">Passport - cannot see everything clearly</option>
                            <option value="IDC-028" data-question="decline-text-1">National identity card - cannot see everything clearly</option>
                        </select>

                        <select id="decline-2" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-030" data-question="">--- Please select ---</option>
                            <option value="IDC-031" data-question="decline-text-4a">Driving licence - whole document is fake</option>
                            <option value="IDC-032" data-question="decline-text-4b">Driving licence - photo or information has been tampered with</option>
                            <option value="IDC-033" data-question="decline-text-4a">Passport - whole document is fake</option>
                            <option value="IDC-033" data-question="decline-text-4b">Passport - photo or information has been tampered with</option>
                            <option value="IDC-033" data-question="decline-text-4a">National identity card - whole document is fake</option>
                            <option value="IDC-033" data-question="decline-text-4b">National identity card - photo or information has been tampered with</option>
                        </select>

                        <select id="decline-3" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-040" data-question="">--- Please select ---</option>
                            <option value="IDC-041" data-question="decline-text-6a">Driving licence - expired</option>
                            <option value="IDC-042" data-question="decline-text-6a">Passport - expired</option>
                            <option value="IDC-043" data-question="decline-text-6a">National identity card - expired</option>
                            <option value="IDC-044" data-question="decline-text-6b">Unsupported UK document</option>
                            <option value="IDC-046" data-question="decline-text-6b">Unsupported non-UK document</option>
                        </select>

                        <select id="decline-4a" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-050" data-question="">--- Please select ---</option>
                            <option value="IDC-051" data-question="decline-text-15a">Driving licence - dates of birth do not match</option>
                            <option value="IDC-051" data-question="decline-text-15a">Passport - dates of birth do not match</option>
                            <option value="IDC-051" data-question="decline-text-15a">National identity card - dates of birth do not match</option>                            
                        </select>

                        <select id="decline-4b" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-050" data-question="">--- Please select ---</option>
                            <option value="IDC-051" data-question="decline-text-15b">Driving licence - first names do not match</option>
                            <option value="IDC-051" data-question="decline-text-15b">Passport - first names do not match</option>
                            <option value="IDC-051" data-question="decline-text-15b">National identity card - first names do not match</option>
                        </select>

                        <select id="decline-4c" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-050" data-question="">--- Please select ---</option>
                            <option value="IDC-051" data-question="decline-text-15c">Driving licence - last names do not match</option>
                            <option value="IDC-054" data-question="decline-text-15c">Passport - last names do not match</option>
                            <option value="IDC-057" data-question="decline-text-15c">National identity card - last names do not match</option>

                        </select>

                        <select id="decline-5" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-080" data-question="">--- Please select ---</option>
                            <option value="IDC-081" data-question="decline-text-8a">There is a face, but it's not clear</option>
                            <option value="IDC-082" data-question="decline-text-8b">There is no face in the video</option>
                            <option value="IDC-083" data-question="decline-text-8c">Nobody is in the video</option>
                        </select>

                        <select id="decline-6" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-090" data-question="">--- Please select ---</option>
                            <option value="IDC-091" data-question="decline-text-10">Driving licence - face in the photo ID does not match face in video</option>
                            <option value="IDC-091" data-question="decline-text-10">Passport - face in the photo ID does not match face in video</option>
                            <option value="IDC-091" data-question="decline-text-10">National identity card - face in the photo ID does not match face in video</option>

                        </select>

                        <select id="decline-7" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-100" data-question="">--- Please select ---</option>
                            <option value="IDC-101" data-question="decline-text-11a">There is no sound at all</option>
                            <option value="IDC-102" data-question="decline-text-11">Cannot see or hear numbers clearly</option> {# this one needs updating - it doesn't mention see in live #}
                            <option value="IDC-103" data-question="decline-text-12">Missing first or last number</option>
                            <option value="IDC-104" data-question="decline-text-13">Numbers are completely wrong</option> {# this one needs updating - it doesn't say completely in live #}
                            <option value="IDC-105" data-question="decline-text-14">Says something other than numbers</option>
                            <option value="IDC-105" data-question="decline-text-14a">Someone else is saying the numbers</option>

                        </select>
                    </div>
                </div>


                <div class="nhsuk-form-group" id="rejection-text" style="display:none;">

                    <div id="decline-text-1" style="display:none;">
                        <label class="nhsuk-label" for="field3">Which part of the ID is affected, and how? (required)</label>
                            <span class="nhsuk-hint">Tell us if:<br>
                            <ul>
                            <li>anything is covered up, and how</li>
                            <li>anything is cut off</li>
                            <li>there is glare</li>
                            <li>there is blur</li>
                            <li>it's too light</li>
                            <li>it's too dark</li>
                            <li>anything else is making it difficult for you to see the information clearly</li>
                            </ul>
                            </span>
                    </div>
                    <div id="decline-text-2a" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-2b" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision, ensuring you include the ticket number. (required)</label>
                    </div>

                    <div id="decline-text-3" style="display:none;">
                        <label class="nhsuk-label" for="field3">"Which dates do not match? (required)</label>
                            <span class="nhsuk-hint">Look at the date of birth:<br>
                                &#9679; in the submitted details<br>
                                &#9679; in PDS<br>
                                &#9679; in the photo ID<br>
                            </span>
                    </div>

                    <div id="decline-text-4a" style="display:none;">
                        <label class="nhsuk-label" for="field3">How did you identify that it's a fake? (required)</label>
                    </div>

                    <div id="decline-text-4b" style="display:none;">
                        <label class="nhsuk-label" for="field3">What has been tampered with, and how? (required)</label>
                    </div>

                    <div id="decline-text-6a" style="display:none;">
                        <label class="nhsuk-label" for="field3"></label>
                    </div>

                    <div id="decline-text-6b" style="display:none;">
                        <label class="nhsuk-label" for="field3">What kind of ID is it? (required)</label>
                    </div>

                    <div id="decline-text-7" style="display:none;">
                        <label class="nhsuk-label" for="field3">Which details do not match, and why? (required)</label>
                    </div>

                    <div id="decline-text-8" style="display:none;">
                        <label class="nhsuk-label" for="field3">Why not? (required)</label>
                        <span class="nhsuk-hint">Tell us if:<br>
                            &#9679; anything is covered up, and how<br>
                            &#9679; anything is cut off<br>
                            &#9679; there is glare<br>
                            &#9679; there is blur<br>
                            &#9679; it's too light<br>
                            &#9679; it's too dark<br>
                            &#9679; anything else is making it difficult for you to see the information clearly<br>
                        </span>
                    </div>
                    
                    <div id="decline-text-8a" style="display:none;">
                        <label class="nhsuk-label" for="field3">Why not? (required)</label>
                        <span class="nhsuk-hint">Tell us if:<br>
                            &#9679; anything is covered up, and how<br>
                            &#9679; anything is cut off<br>
                            &#9679; there is glare<br>
                            &#9679; there is blur<br>
                            &#9679; it's too light<br>
                            &#9679; it's too dark<br>
                            &#9679; anything else is making it difficult for you to see the information clearly<br>
                        </span>
                    </div>

                    <div id="decline-text-8b" style="display:none;">
                        <label class="nhsuk-label" for="field3">What can you see? (required)</label>
                    </div>

                    <div id="decline-text-8c" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (required)</label>
                    </div>


                    <div id="decline-text-9" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain how the face is covered</label>
                    </div>

                    <div id="decline-text-10" style="display:none;">
                        <label class="nhsuk-label" for="field3">More information about why you think they do not match (optional)</label>
                    </div>

                    <div id="decline-text-11a" style="display:none;">
                        <label class="nhsuk-label" for="field3"></label>
                    </div>

                    <div id="decline-text-11" style="display:none;">
                        <label class="nhsuk-label" for="field3">Why can't you see or hear the numbers clearly? (required)</label> {# this one needs updating - it doesn't mention see in live #}
                    </div>

                    <div id="decline-text-12" style="display:none;">
                        <label class="nhsuk-label" for="field3">Which numbers do they miss? (required)</label>
                    </div>

                    <div id="decline-text-13" style="display:none;">
                        <label class="nhsuk-label" for="field3">More information about why they were wrong (optional)</label>
                    </div>

                    <div id="decline-text-14" style="display:none;">
                        <label class="nhsuk-label" for="field3">What do they say? (required)</label>
                    </div>

                    <div id="decline-text-14a" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-15" style="display:none;">
                        <label class="nhsuk-label" for="field3" style="display:none;"></label>
                    </div>

                    <div id="decline-text-15a" style="display:none;">
                        <label class="nhsuk-label" for="field3"></label>
                    </div>

                    <div id="decline-text-15b" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-15c" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-16" style="display:none;">
                        <label class="nhsuk-label" for="field3" style="display:block;">What is the 'other' reason?</label>
                    </div>

                    <textarea class="nhsuk-textarea" id="field3" name="field3" type="text" rows="3"
                              style="margin-top: 16px;" onkeyup='checkText(this.value);'></textarea>
                </div>

                <div class="form-group nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                    <button class="nhsuk-button full-width nhsuk-u-margin-bottom-3 nhsuk-u-margin-top-0" id="modal-link-decline" style="width:100%;"
                       href="supervisor-dashboard" disabled="disabled">Submit</button>
                </div>
                <div class="form-group nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                    <p class="nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-3 nhsuk-u-margin-left-3" style="display:inline-block;"><a href="#" onclick="" id="modal_close">Cancel</a></p>
                </div>
            </form> 
        </div>

                <!-- MOVE TO HOLD QUEUE MODALLLLL 
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        ---------------->


        <div class="first-item" id="moveHold-modal" style="display:none"> 
            <form action="reject" method="POST" role="form">

                

                <div class="nhsuk-form-group">

                    <div id="modal-clarity" style="display:none;">

                        <div class="nhsuk-grid-row">
                            <div class="nhsuk-grid-column-two-thirds">
<!--                                <div class="idcheck-image" style="margin-top:0;">-->
<!--                                    <img src="/images/passport_redacted.jpg" class="idcheck-image-img" style="width: 100%;"-->
<!--                                         alt="Image of a passport"/>-->
<!--                                </div>-->

                                <div class="idcheck-image-container panzoom-parent">

                                    <div class="idcheck-image zoomable5">

                                        <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                                             alt="Picture of an identity document"/>

                                    </div>

                                </div>
                            </div>

                            <div class="nhsuk-grid-column-one-third nhsuk-u-margin-top-0">

                                <div class="nhsuk-form-group">

                                    <fieldset class="nhsuk-fieldset">

                                        <div class="nhsuk-checkboxes nhsuk-checkboxes--small">

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0 ">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-1" name="example-hint" type="checkbox" value="blur">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-1">
                                                    It's too blurred
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-2" name="example-hint" type="checkbox" value="glare">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-2">
                                                    There's too much glare
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0" id="idcheck-clarity-hologram" style="display:none;">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-holo" name="example-hint" type="checkbox" value="glare">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-holo">
                                                    The hologram is hiding some information
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-3" name="example-hint" type="checkbox" value="light">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-3">
                                                    It's too light (overexposed)
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-4" name="example-hint" type="checkbox" value="dark">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-4">
                                                    It's too dark
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-5" name="example-hint" type="checkbox" value="cropped">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-5">
                                                    It's cropped (part of the document is not in the photo)
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-6" name="example-hint" type="checkbox" value="covered">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-6">
                                                    Something is covering some or all of the document
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-7" name="example-hint" type="checkbox" value="small">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-7">
                                                    It's too small
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-8" name="example-hint" type="checkbox" value="dirty">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-8">
                                                    It's too dirty
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-9" name="example-hint" type="checkbox" value="filtered">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-9">
                                                    A photo filter has been applied
                                                </label>
                                            </div>

                                            <div class="nhsuk-checkboxes__item nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                                                <input class="nhsuk-checkboxes__input" id="example-hint-10" name="example-hint" type="checkbox" value="other" data-question="decline-text-16">
                                                <label class="nhsuk-label nhsuk-checkboxes__label" for="example-hint-10">
                                                    Other
                                                </label>
                                            </div>

                                        </div>
                                    </fieldset>

                                </div>

                            </div>
                        </div>
                    </div>



                    <div id="rejection-reasons">

                        <select id="decline-0" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-010" data-question="">--- Please select ---</option>

                            <option value="IDC-011" data-question="decline-text-2a">No record found</option>
                            <option value="IDC-012" data-question="decline-text-2b">Duplicate live records found</option>
                            <option value="IDC-013" data-question="decline-text-2b">Confusion record</option>
                            <option value="IDC-014" data-question="decline-text-2a">PDS issue with record</option>
                            <option value="IDC-015" data-question="decline-text-2a">Date of birth does not match</option>
                            <option value="IDC-016" data-question="decline-text-2a">Postcodes do not match</option>


                        </select>


                        <select id="decline-1" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-023" data-question="">--- Please select ---</option>
                            {# <option value="IDC-024" data-question="none">User has not sent any ID at all</option> #}
                            {# <option value="IDC-025" data-question="none">It is not a type of ID we accept</option> #}
                            <option value="IDC-026" data-question="decline-text-1">Driving licence - cannot see everything clearly</option>
                            <option value="IDC-027" data-question="decline-text-1">Passport - cannot see everything clearly</option>
                            <option value="IDC-028" data-question="decline-text-1">National identity card - cannot see everything clearly</option>
                        </select>

                        <select id="decline-2" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-030" data-question="">--- Please select ---</option>
                            <option value="IDC-031" data-question="decline-text-4a">Driving licence - whole document is fake</option>
                            <option value="IDC-032" data-question="decline-text-4b">Driving licence - photo or information has been tampered with</option>
                            <option value="IDC-033" data-question="decline-text-4a">Passport - whole document is fake</option>
                            <option value="IDC-033" data-question="decline-text-4b">Passport - photo or information has been tampered with</option>
                            <option value="IDC-033" data-question="decline-text-4a">National identity card - whole document is fake</option>
                            <option value="IDC-033" data-question="decline-text-4b">National identity card - photo or information has been tampered with</option>
                        </select>

                        <select id="decline-3" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-040" data-question="">--- Please select ---</option>
                            <option value="IDC-041" data-question="decline-text-6a">Driving licence - expired</option>
                            <option value="IDC-042" data-question="decline-text-6a">Passport - expired</option>
                            <option value="IDC-043" data-question="decline-text-6a">National identity card - expired</option>
                            <option value="IDC-044" data-question="decline-text-6b">Unsupported UK document</option>
                            <option value="IDC-046" data-question="decline-text-6b">Unsupported non-UK document</option>
                        </select>

                        <select id="decline-4a" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-050" data-question="">--- Please select ---</option>
                            <option value="IDC-051" data-question="decline-text-15a">Driving licence - dates of birth do not match</option>
                            <option value="IDC-051" data-question="decline-text-15a">Passport - dates of birth do not match</option>
                            <option value="IDC-051" data-question="decline-text-15a">National identity card - dates of birth do not match</option>                            
                        </select>

                        <select id="decline-4b" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-050" data-question="">--- Please select ---</option>
                            <option value="IDC-051" data-question="decline-text-15b">Driving licence - first names do not match</option>
                            <option value="IDC-051" data-question="decline-text-15b">Passport - first names do not match</option>
                            <option value="IDC-051" data-question="decline-text-15b">National identity card - first names do not match</option>
                        </select>

                        <select id="decline-4c" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-050" data-question="">--- Please select ---</option>
                            <option value="IDC-051" data-question="decline-text-15c">Driving licence - last names do not match</option>
                            <option value="IDC-054" data-question="decline-text-15c">Passport - last names do not match</option>
                            <option value="IDC-057" data-question="decline-text-15c">National identity card - last names do not match</option>

                        </select>

                        <select id="decline-5" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-080" data-question="">--- Please select ---</option>
                            <option value="IDC-081" data-question="decline-text-8a">There is a face, but it's not clear</option>
                            <option value="IDC-082" data-question="decline-text-8b">There is no face in the video</option>
                            <option value="IDC-083" data-question="decline-text-8c">Nobody is in the video</option>
                        </select>

                        <select id="decline-6" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-090" data-question="">--- Please select ---</option>
                            <option value="IDC-091" data-question="decline-text-10">Driving licence - face in the photo ID does not match face in video</option>
                            <option value="IDC-091" data-question="decline-text-10">Passport - face in the photo ID does not match face in video</option>
                            <option value="IDC-091" data-question="decline-text-10">National identity card - face in the photo ID does not match face in video</option>

                        </select>

                        <select id="decline-7" class="nhsuk-select decline-group" id="sort" name="sort" style="margin-top:16px;width:100%;display:none;">
                            <option value="IDC-100" data-question="">--- Please select ---</option>
                            <option value="IDC-101" data-question="decline-text-11a">There is no sound at all</option>
                            <option value="IDC-102" data-question="decline-text-11">Cannot see or hear numbers clearly</option> {# this one needs updating - it doesn't mention see in live #}
                            <option value="IDC-103" data-question="decline-text-12">Missing first or last number</option>
                            <option value="IDC-104" data-question="decline-text-13">Numbers are completely wrong</option> {# this one needs updating - it doesn't say completely in live #}
                            <option value="IDC-105" data-question="decline-text-14">Says something other than numbers</option>
                            <option value="IDC-105" data-question="decline-text-14a">Someone else is saying the numbers</option>

                        </select>
                    </div>
                </div>


                <div class="nhsuk-form-group" id="rejection-text" style="display:none;">

                    <div id="decline-text-1" style="display:none;">
                        <label class="nhsuk-label" for="field3">Which part of the ID is affected, and how? (required)</label>
                            <span class="nhsuk-hint">Tell us if:<br>
                            <ul>
                            <li>anything is covered up, and how</li>
                            <li>anything is cut off</li>
                            <li>there is glare</li>
                            <li>there is blur</li>
                            <li>it's too light</li>
                            <li>it's too dark</li>
                            <li>anything else is making it difficult for you to see the information clearly</li>
                            </ul>
                            </span>
                    </div>
                    <div id="decline-text-2a" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-2b" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision, ensuring you include the ticket number. (required)</label>
                    </div>

                    <div id="decline-text-3" style="display:none;">
                        <label class="nhsuk-label" for="field3">"Which dates do not match? (required)</label>
                            <span class="nhsuk-hint">Look at the date of birth:<br>
                                &#9679; in the submitted details<br>
                                &#9679; in PDS<br>
                                &#9679; in the photo ID<br>
                            </span>
                    </div>

                    <div id="decline-text-4a" style="display:none;">
                        <label class="nhsuk-label" for="field3">How did you identify that it's a fake? (required)</label>
                    </div>

                    <div id="decline-text-4b" style="display:none;">
                        <label class="nhsuk-label" for="field3">What has been tampered with, and how? (required)</label>
                    </div>

                    <div id="decline-text-6a" style="display:none;">
                        <label class="nhsuk-label" for="field3"></label>
                    </div>

                    <div id="decline-text-6b" style="display:none;">
                        <label class="nhsuk-label" for="field3">What kind of ID is it? (required)</label>
                    </div>

                    <div id="decline-text-7" style="display:none;">
                        <label class="nhsuk-label" for="field3">Which details do not match, and why? (required)</label>
                    </div>

                    <div id="decline-text-8" style="display:none;">
                        <label class="nhsuk-label" for="field3">Why not? (required)</label>
                        <span class="nhsuk-hint">Tell us if:<br>
                            &#9679; anything is covered up, and how<br>
                            &#9679; anything is cut off<br>
                            &#9679; there is glare<br>
                            &#9679; there is blur<br>
                            &#9679; it's too light<br>
                            &#9679; it's too dark<br>
                            &#9679; anything else is making it difficult for you to see the information clearly<br>
                        </span>
                    </div>
                    
                    <div id="decline-text-8a" style="display:none;">
                        <label class="nhsuk-label" for="field3">Why not? (required)</label>
                        <span class="nhsuk-hint">Tell us if:<br>
                            &#9679; anything is covered up, and how<br>
                            &#9679; anything is cut off<br>
                            &#9679; there is glare<br>
                            &#9679; there is blur<br>
                            &#9679; it's too light<br>
                            &#9679; it's too dark<br>
                            &#9679; anything else is making it difficult for you to see the information clearly<br>
                        </span>
                    </div>

                    <div id="decline-text-8b" style="display:none;">
                        <label class="nhsuk-label" for="field3">What can you see? (required)</label>
                    </div>

                    <div id="decline-text-8c" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (required)</label>
                    </div>


                    <div id="decline-text-9" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain how the face is covered</label>
                    </div>

                    <div id="decline-text-10" style="display:none;">
                        <label class="nhsuk-label" for="field3">More information about why you think they do not match (optional)</label>
                    </div>

                    <div id="decline-text-11a" style="display:none;">
                        <label class="nhsuk-label" for="field3"></label>
                    </div>

                    <div id="decline-text-11" style="display:none;">
                        <label class="nhsuk-label" for="field3">Why can't you see or hear the numbers clearly? (required)</label> {# this one needs updating - it doesn't mention see in live #}
                    </div>

                    <div id="decline-text-12" style="display:none;">
                        <label class="nhsuk-label" for="field3">Which numbers do they miss? (required)</label>
                    </div>

                    <div id="decline-text-13" style="display:none;">
                        <label class="nhsuk-label" for="field3">More information about why they were wrong (optional)</label>
                    </div>

                    <div id="decline-text-14" style="display:none;">
                        <label class="nhsuk-label" for="field3">What do they say? (required)</label>
                    </div>

                    <div id="decline-text-14a" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-15" style="display:none;">
                        <label class="nhsuk-label" for="field3" style="display:none;"></label>
                    </div>

                    <div id="decline-text-15a" style="display:none;">
                        <label class="nhsuk-label" for="field3"></label>
                    </div>

                    <div id="decline-text-15b" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-15c" style="display:none;">
                        <label class="nhsuk-label" for="field3">Explain why you made this decision (optional)</label>
                    </div>

                    <div id="decline-text-16" style="display:none;">
                        <label class="nhsuk-label" for="field3" style="display:block;">What is the 'other' reason?</label>
                    </div>

                    <textarea class="nhsuk-textarea" id="field3" name="field3" type="text" rows="3"
                              style="margin-top: 16px;" onkeyup='checkText(this.value);'></textarea>
                </div>

                <div class="form-group nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                    <button class="nhsuk-button full-width nhsuk-u-margin-bottom-3 nhsuk-u-margin-top-0" id="modal-link-decline" style="width:100%;"
                       href="supervisor-dashboard" disabled="disabled">Submit</button>
                </div>
                <div class="form-group nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-0">
                    <p class="nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-3 nhsuk-u-margin-left-3" style="display:inline-block;"><a href="#" onclick="" id="modal_close">Cancel</a></p>
                </div>
            </form> 
        </div>

    </div> <!-- end .modal-content -->
</div> <!-- end .modal-overlay --> 










<p class="u-visuallyhidden" style="visibility: hidden;"><a id="modal_create" class="smartcard" href="#">.</a><a id="holding" href="dashboard">.</a></p>

</div>


<script type="text/javascript">
    /* eslint-disable indent */

    // hide or show the buttons based on selections
    // localStorage.removeItem("idchecker")
    addEventListeners()
    addButtonListeners()
    addClarityButtonListeners()
    addRejectionListeners()
    resetAllSections()
    addRetraceListener()
    addOtherListener()
    addSlideoutListener()
    questionsComplete = false

////////////////////////////



////////////////////////////////////////////////

    // Change the trancoded button on click
{#             function change()
        {
            var elem = document.getElementById("transcodelink");
            if (elem.innerHTML=="Show the original video") elem.innerHTML = "Show the transcoded video";
            else elem.innerHTML = "Show the original video";
        } #}

{# var btn = document.getElementById("transcodelink");
btn.value = 'my value'; // will just add a hidden value
btn.innerHTML = 'my text'; #}


    function getParameterByName(name, url) {
        if (!url) url = window.location.href
        name = name.replace(/[\[\]]/g, "\\$&")
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url)
        if (!results) return null
        if (!results[2]) return ''
        return decodeURIComponent(results[2].replace(/\+/g, " "))
    }

    var state = getParameterByName('state')

    setTimeout(function () {
        document.getElementById('trace').style.display = 'block'
        // document.getElementById('retrybtn-1').style.display = 'block'
        if (state === 'noresult') {
            $('label[for="1"]').click()
        }
    }, 2000)
    setTimeout(function () {
        document.getElementById('loader').style.display = 'none'
    }, 2000)

    setTimeout(function () {
        document.getElementById('declinebtn-2').style.display = 'block'
        var errors = document.getElementsByClassName('idcheck-edit')
        for (i = 0; i < errors.length; i++) {
            errors[i].style.display = 'inline-block'
        }
        if (state === 'noresult') {
            $('label[for="1"]').click()
        }
    }, 2000)

    setTimeout(function () {
        document.getElementById('slideout-value_tab_spinner').style.display = 'none'
    }, 4000)

    setTimeout(function () {
        document.getElementById('slideout-value_tab_value').style.display = 'block'
    }, 4000)

    // when any radio button is clicked
    var processClick = function (e) {
        // update local storage straight away
        updateStorageFromElements()

        // first unset all the aria-checked attributes in an answer group
        var labels = e.parentNode.getElementsByClassName('qa-questions-answer')

        for (i = 0; i < labels.length; i++) {
            labels[i].setAttribute('aria-checked', false)
        }
        // then check only the selected one
        e.setAttribute('aria-checked', true)

        // a click will trigger the showing and hiding of question groups

        // get the section the click was in and pass it into a function
        var section = e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        checkSectionComplete(section)
    }

    // when an approve or decline button is clicked
    var buttonClick = function (object, event) {
        event.preventDefault()

        var target = object.parentElement.parentElement.getAttribute('data-group')

        var link = object.href
        var heading = document.getElementById('modal-header')

        var content = document.getElementById('modal_holder')
        content.classList.remove('modal-content--clarity')

        document.getElementById('modal-clarity').style.display = 'none'

        heading.innerText = 'Information about this declined verification'
        var a = document.getElementById('modal-link')
        a.href = link
        document.getElementById('modal_create').click()

        var buttonType = object.id

        if (object.id === 'declineBtn') {
            document.getElementById('decline-modal').style.display = 'block'
            document.getElementById('approve-modal').style.display = 'none'
            document.getElementById('moveHold-modal').style.display = 'none'
            console.log(target)
            if (target === 'decline-5') {
                heading.innerText = 'Select the reason for rejection'
            } else if (target === 'decline-0') {
                heading.innerText = 'Select the reason for rejection'
            } else if (target === 'decline-7') {
                heading.innerText = 'Select the reason for rejection'
            } else {
                heading.innerText = 'Select the reason for rejection'
            }
            setSubReasons('')
            setReasons(target)

        } else if (object.id === 'approveBtn') {
        heading.innerText = 'Do you confirm the record has passed all checks?';
        document.getElementById('approve-modal').style.display = 'block';
        document.getElementById('decline-modal').style.display = 'none';
        document.getElementById('moveHold-modal').style.display = 'none'

        } else if (object.id === 'slideout__button') {
            document.getElementById('moveHold-modal').style.display = 'block'
            document.getElementById('approve-modal').style.display = 'none'
            document.getElementById('decline-modal').style.display = 'none';
            console.log(target)
            if (target === 'decline-5') {
                heading.innerText = 'Select the reason for rejection'
            } else if (target === 'decline-0') {
                heading.innerText = 'Select the reason for rejection'
            } else if (target === 'decline-7') {
                heading.innerText = 'Select the reason for rejection'
            } else {
                heading.innerText = 'Select the reason for rejection'
            }
            
            document.getElementById('modal_create').click()

        }
    }

  
    // when a don't know button is clicked
    var clarityClick = function (object, event) {
        event.preventDefault()

        var link = object.href
        var heading = document.getElementById('modal-header')

        var clarityQuestion = object.parentNode.getAttribute('id')

        console.log(clarityQuestion)

        if (clarityQuestion === 'id-canttell2') {
            heading.innerText = 'Select all the reasons you cannot answer this question'
        } else if (clarityQuestion === 'id-canttell3') {
            heading.innerText = 'Select the reason you cannot confirm whether it\'s a valid document (select all that apply)'
          document.getElementById('idcheck-clarity-hologram').style.display = 'block'
        } else if (clarityQuestion === 'selfie-2') {
            heading.innerText = 'Information about this declined verification (Faces do not match)'
        }

        var content = document.getElementById('modal_holder')
        content.classList.add('modal-content--clarity')

        document.getElementById('modal-link').removeAttribute('disabled')

        document.getElementById('modal-clarity').style.display = 'block'

        var rejections = document.getElementById('rejection-reasons')
        rejections.style.display = 'none'

        var a = document.getElementById('modal-link')
        a.href = link
        document.getElementById('modal_create').click()

        var buttonType = object.text
    }

    function setReasons(target) {
        // first do a reset
        console.log("set reasons")
        // get all the dropdowns into an array;
        document.getElementById('rejection-reasons').style.display = 'block'
        var reasons = document.getElementsByClassName('decline-group')
        for (i = 0; i < reasons.length; i++) {
            reasons[i].style.display = 'none'
            reasons[i].selectedIndex = "0";
        }
        if (target){
            document.getElementById(target).style.display = 'block'
        }
    }

    var selectChange = function (object, event) {
        var target = object.options[object.selectedIndex].getAttribute('data-question')
        setSubReasons(target)
    }

    function setSubReasons(target) {


        // reset everything before showing the picked one
        var subReasons = document.getElementById('rejection-text').getElementsByTagName('div')
        resetText()
        for (i = 0; i < subReasons.length; i++) {
            subReasons[i].style.display = 'none'
        }
        if (target){

          console.log(target)

            if (target === "decline-text-15" || target === "none" ) {
                document.getElementById('modal-link').removeAttribute("disabled")
              document.getElementById('rejection-text').style.display = 'none'
            } else {
                document.getElementById('rejection-text').style.display = 'block'

                if (target === "decline-text-16") {
                    console.log('hello')
                }
            }

            document.getElementById(target).style.display = 'block'
            // show the text area
            // document.getElementById('rejection-text').style.display = 'block'
        } else {
            document.getElementById('rejection-text').style.display = 'none'
        }
    }

    function checkText(text) {
        if(text.length >= 1) {
            document.getElementById('modal-link-decline').removeAttribute("disabled")
        } else if(text.length == 0) {
            document.getElementById('modal-link-decline').setAttribute("disabled", '')
        }
    }

    function conFirm() {
        if((document.getElementById('confirm').checked)) {
            document.getElementById('modal-link').removeAttribute("disabled")
        } else {
            document.getElementById('modal-link').setAttribute("disabled", '')
        }
    }

  // Close modal on clicking overlay 
  var closeoverlay = document.getElementById('modal_window');
    var overlay = document.getElementById('modal_holder');

    overlay.addEventListener("click", function(e) {
    e.stopPropagation();
    });

    closeoverlay.addEventListener("click", function(e) {
        closeOverlay( e );
    });

    // Close approve modal and reset checkbox on clicking cancel 
    function closeOverlay() {
        document.getElementById('modal_window').setAttribute('aria-hidden', 'true')
        document.getElementById('modal_window').setAttribute('tabindex', '-1')
        let inputs = document.getElementById('confirm');
        inputs.checked = false;
        document.getElementById('modal-link').setAttribute("disabled", '')
        event.preventDefault()
        modalOpen = false
        lastFocus.focus()
    }  


    function resetText() {
        var textarea = document.getElementById('field3')
        textarea.value = ''
        document.getElementById('modal-link-decline').setAttribute("disabled", '')
    }

    function retrace() {
        document.getElementById('trace').style.display = 'none'
        document.getElementById('declinebtn-2').style.display = 'none'
        document.getElementById('loader').style.display = 'block'
        setTimeout(function () {
            document.getElementById('retrace').style.display = 'block'
            document.getElementById('pds-retrace-result').style.display = 'block'
        }, 2000)
        setTimeout(function () {
            document.getElementById('loader').style.display = 'none'
            document.getElementById('pds-result').style.display = 'none'
        }, 2000)
    }

    // run through all sections checking for completeness
    function resetAllSections() {
        // get an array of all the question groups
        var questionGroups = document.getElementsByClassName('qa-questions-group')
        // lets hold the completion state of each section in an array
        for (i = 0; i < questionGroups.length; i++) {
            // reset attributes
            questionGroups[i].setAttribute('data-complete', false)
            // get array of all the answer groups
            var questions = questionGroups[i].getElementsByClassName('qa-questions-question')
            // loop through all the question groups
            for (j = 0; j < questions.length; j++) {
                // get array of the labels
                var answers = questionGroups[i].getElementsByClassName('qa-questions-answer')
                // loop through answers
                for (k = 0; k < answers.length; k++) {
                    answers[k].setAttribute('aria-checked', false)
                    // get the individual inputs
                    var inputs = answers[k].getElementsByTagName('input')
                    // loop through all the inputs and uncheck them
                    for (l = 0; l < answers.length; l++) {
                      // answers[l].checked = false
                      answers[l].disabled = true
                    }
                }
            }
        }
        unlockFirstQuestion()
    }



    function addEventListeners() {
        var inputs = document.getElementsByTagName('input')
        for (i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('click', function () {
                processClick(this)
            })
        }
    }

    function addButtonListeners() {
        var inputs = document.querySelectorAll('.button--modal')
        for (i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('click', function (event) {
                buttonClick(this, event)
            })
        }
    }


    function addClarityButtonListeners() {
        var inputs = document.querySelectorAll('.button--decline--clarity')
        for (i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('click', function (event) {
                clarityClick(this, event)
            })
        }
    }

    function addRejectionListeners() {
        var selects = document.querySelectorAll('.decline-group')
        for (i = 0; i < selects.length; i++) {
            selects[i].addEventListener('change', function (event) {
                selectChange(this, event)
            })
        }
    }

    function addOtherListener() {
        if (document.getElementById('example-hint-10')) {
            var selects = document.getElementById('example-hint-10')
            selects.addEventListener('change', function () {
                if(this.checked) {
                    // selectChange(this, event)
                    var target = this.getAttribute('data-question')
                    setSubReasons(target)
                } else {
                    var target = this.getAttribute('data-question')
                    setSubReasons(target)
                }
            })
        }
    }

    function addRetraceListener() {
        if (document.getElementById('retraceBtn')) {
            var selects = document.getElementById('retraceBtn')
            selects.addEventListener('click', function (event) {
                retrace(this, event)
            })
        }
    }

    function addSlideoutListener() {
    var slideoutButton = document.getElementById('slideout__button');
    if (slideoutButton) {
        slideoutButton.addEventListener('click', function(event) {
            buttonClick(this, event);
        });
    }
}

    function updateStorageFromElements() {
        var idCheck = []
        var inputs = document.getElementsByTagName('input')
        for (i = 0; i < inputs.length; i++) {
            var inputId = inputs[i].getAttribute('id')
            idCheck[inputId] = inputs[i].checked
        }
        localStorage.setItem('idchecker', JSON.stringify(idCheck))
    }

    function checkSectionComplete(section) {
        // get an array of all the question subgroups
        var questions = section.getElementsByClassName('qa-questions-question')
        var sectionComplete = true
        for (i = 0; i < questions.length; i++) {
            var inputs = questions[i].getElementsByTagName('input')
            var questionComplete = false
            for (j = 0; j < inputs.length; j++) {
                if (inputs[j].checked) {
                    questionComplete = true
                }
            }
            if (false === questionComplete) {
                sectionComplete = false
            }
        }
        if (sectionComplete) {
            section.setAttribute('data-complete', true)
            unlockNextSection(section)
            return true
        }
    }

    function unlockNextSection(section) {
        var id = section.getElementsByClassName('qa-questions-question')[0].getAttribute('id')
        var sections = []
        var groups = document.getElementsByClassName('qa-questions-group')
        for (i = 0; i < groups.length; i++) {
            sections[i] = groups[i].getElementsByClassName('qa-questions-question')[0].getAttribute('id')
        }
        // work out what the next section is
        var currentSectionPosition = sections.indexOf(id)
        var nextSectionPosition = currentSectionPosition + 1
        var lastSection = sections[groups.length-1]

       console.log("unlock " + nextSectionPosition)
        // console.log(lastSection)

        if (currentSectionPosition < groups.length-1 ){
            var nextSection = sections[nextSectionPosition]
            // get the next section object
            nextSection = document.getElementById(nextSection)

            // enable radio buttons
            var nextRadios = nextSection.getElementsByTagName('input')

            // enable next clarity link
          if (document.getElementById(sections[nextSectionPosition]).parentNode.getElementsByClassName('button--decline--clarity')[0]) {
            console.log("clarity question exists in next section")
            document.getElementById(sections[nextSectionPosition]).parentNode.getElementsByClassName('button--decline--clarity')[0].classList.remove('disabled')
          }

            for (j = 0; j < nextRadios.length; j++) {
                nextRadios[j].disabled = false
            }
        }
        updateSolutions()
    }

    function updateSolutions() {
        // pull in the answer array
        var idCheck = JSON.parse(localStorage['idchecker'])

        if (idCheck[11] === true ) {
            document.getElementById('manual-pds-1').style.display = 'block'
            document.getElementById('radio-inline-3').disabled = false
            document.getElementById('radio-inline-4').disabled = false
        }
        else if (idCheck[10] === true ) {
            document.getElementById('manual-pds-1').style.display = 'none'
        }

        if (idCheck[13] === true ) {
            document.getElementById('manual-pds-2').style.display = 'block'
            document.getElementById('radio-inline-5').disabled = false
            document.getElementById('radio-inline-6').disabled = false
        }
        else if (idCheck[12] === true ) {
            document.getElementById('manual-pds-2').style.display = 'none'
        }

        if (idCheck[1] === true || idCheck[3] === true || idCheck[5] === true || idCheck[9] === true || idCheck[15] === true || idCheck[17] === true || idCheck[20] === true ) {

            console.log('something is off')
            if (document.getElementById('radio-inline-3') !== true ) {

                document.getElementById('approveBtn').style.display = 'none'
                document.getElementById('declineBtn').style.display = 'inline-block'

                // var declineButton = document.getElementById('id-decline')
                // document.getElementById('#document-1').append(declineButton)

                // document.getElementById('canttellBtn').style.display = 'none'

                if (idCheck[1] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('document-1').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[3] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('document-2').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[5] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('document-3').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[9] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('pds-1').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[15] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('selfie-1').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[17] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('selfie-2').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[20] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('selfie-3').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('id-buttons').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                }
            }
        }

        else if (idCheck[0] === true && idCheck[2] === true && idCheck[4] === true && idCheck[8] === true && idCheck[10] === true && idCheck[12] === true && idCheck[14] === true && idCheck[16] === true && idCheck[19] === true) {

            console.log('yay all yes')
            document.getElementById('approveBtn').style.display = 'inline-block'
            document.getElementById('declineBtn').style.display = 'none'
            // document.getElementById('canttellBtn').style.display = 'none'
           
        }

        else if (idCheck[0] === true && idCheck[2] === true && idCheck[4] === true && idCheck[8] === true && idCheck['radio-inline-3'] === true && idCheck['radio-inline-4'] === true && idCheck[14] === true && idCheck[16] === true && idCheck[19] === true) {

            console.log('yay all yesses')
            document.getElementById('approveBtn').style.display = 'inline-block'
            document.getElementById('declineBtn').style.display = 'none'
            // document.getElementById('canttellBtn').style.display = 'none'
        }

        else {
            document.getElementById('approveBtn').style.display = 'none'
            document.getElementById('declineBtn').style.display = 'none'
            // document.getElementById('canttellBtn').style.display = 'none'
        }

    }

    function unlockFirstQuestion() {
        // console.log("unlock")

        // get an array of all the question groups
        var questionGroup1 = document.getElementById('document-1')
        var questionGroup2 = document.getElementById('document-2')
        var questionGroup3 = document.getElementById('document-3')
        //
        var inputs = questionGroup1.getElementsByTagName('input')
        // // loop through all the inputs and uncheck them
        for (l = 0; l < inputs.length; l++) {
            inputs[l].checked = false
            inputs[l].disabled = false
        }

        // check to see if document check has passed
        // If yes, then disable all the radios for the doc check section and select the

        if ({{ data.idv[data.prototype.count].doc_check_passes }}) {

            var inputs1 = questionGroup1.getElementsByTagName('input')
            var inputs2 = questionGroup2.getElementsByTagName('input')
            var inputs3 = questionGroup3.getElementsByTagName('input')
            for (m = 0; m < inputs1.length; m++) {
                inputs1[0].checked = false;
                // inputs1[m].disabled = true;
                inputs2[0].checked = false;
                inputs2[m].disabled = true;
                inputs3[0].checked = false;
                inputs3[m].disabled = true;
            }

            if ({{ data.idv[data.prototype.count].pds_matches }} === 'true') {
                console.log("unlock date of birth question")
                var questionGroup4 = document.getElementById('pds-1')
                var inputs4 = questionGroup4.getElementsByTagName('input')
                // // loop through all the inputs and uncheck them
                for (n = 0; n < inputs4.length; n++) {
                    inputs4[n].checked = false
                    inputs4[n].disabled = false
                }
            }else {
                console.log("unlock: can you find record question")
                var questionGroup5 = document.getElementById('trace-1')
                var inputs5 = questionGroup5.getElementsByTagName('input')
                // // loop through all the inputs and uncheck them
                for (n = 0; n < inputs5.length; n++) {
                    inputs5[n].checked = false
                    inputs5[n].disabled = false
                }
            }
        }
        // updateSolutions()
    }


</script>

{% endblock %}

{% block pageScripts %}
<script>
    const photo1 = document.querySelector('.zoomable1')
    const photo2 = document.querySelector('.zoomable2')
    const photo3 = document.querySelector('.zoomable3')
    const photo4 = document.querySelector('.zoomable4')
    const photo5 = document.querySelector('.zoomable5')

    let area1 = panzoom(photo1, {
        smoothScroll: false,
        bounds: true,
        boundsPadding: 0.75,
        minZoom: 1,
        maxZoom: 5,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        }
    })

    // NEED IF STATEMENT HERE IF BACK IMAGE EXISTS

    // let area2 = panzoom(photo2, {
    //     smoothScroll: false,
    //     beforeWheel: function(e) {
    //         // allow wheel-zoom only if altKey is down. Otherwise - ignore
    //         var shouldIgnore = !e.altKey
    //         return shouldIgnore
    //     }
    // })
    let area3 = panzoom(photo3, {
        smoothScroll: false,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        },
        bounds: true,
        boundsPadding: 0.75,
        minZoom: 1,
        maxZoom: 5
    })
    let area4 = panzoom(photo4, {
        smoothScroll: false,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        },
        bounds: true,
        boundsPadding: 0.75,
        minZoom: 1,
        maxZoom: 5,
        transformOrigin: {x: 0.5, y: 0.5}
    })
    let area5 = panzoom(photo5, {
        smoothScroll: false,
        bounds: true,
        boundsPadding: 0.75,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        },
        minZoom: 1,
        maxZoom: 5
    })

    var reset = document.getElementById('reset')
    reset.addEventListener('click', function (event) {
        console.log('clicked')
        area1.zoomTo(1, 1, 0)
        area1.moveTo(0, 0)

        // document.getElementsByClassName('zoomable1')[0].style.transform = 'matrix(1, 0, 0, 1, 0, 0)'
        console.log(document.getElementsByClassName('zoomable1')[0])
    })


</script>
{% endblock %}
