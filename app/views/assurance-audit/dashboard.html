{% extends 'layout.html' %}


{% set service = "idchecker" %}
{% set signedin = 'true' %}
{% set params = "?demographics=" + demographics + "&role=" + role + "&result=" + result + "&failreason=" + failreason + "&devMode=" + devMode + "&automation=" + automation  %}
{% set dataResult = 'data-result=' + result %}

{% block extrastyles %}
<script src='/panzoom.min.js'></script>
{% endblock %}


<!-- 
    \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
    ---------------------   ASSURANCE AUDIT VIEW HEADER OVERRIDE ------------------
    \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
-->

{% block header %}
<header class="nhsuk-header-audit-view nhsuk-header--organisation nhsuk-header--white" role="banner">
    <div class="nhsuk-width-container nhsuk-header__container">
        <div class="nhsuk-header__logo nhsuk-header__logo--only">
            <a class="nhsuk-header__link nhsuk-header__link--service " href="/" aria-label="NHS login ID verification assurance audit">
                
                    <svg class="nhsuk-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 16" height="40" width="100">
                        <path class="nhsuk-logo__background" fill="#005eb8" d="M0 0h40v16H0z"></path>
                        <path class="nhsuk-logo__text" fill="#fff" d="M3.9 1.5h4.4l2.6 9h.1l1.8-9h3.3l-2.8 13H9l-2.7-9h-.1l-1.8 9H1.1M17.3 1.5h3.6l-1 4.9h4L25 1.5h3.5l-2.7 13h-3.5l1.1-5.6h-4.1l-1.2 5.6h-3.4M37.7 4.4c-.7-.3-1.6-.6-2.9-.6-1.4 0-2.5.2-2.5 1.3 0 1.8 5.1 1.2 5.1 5.1 0 3.6-3.3 4.5-6.4 4.5-1.3 0-2.9-.3-4-.7l.8-2.7c.7.4 2.1.7 3.2.7s2.8-.2 2.8-1.5c0-2.1-5.1-1.3-5.1-5 0-3.4 2.9-4.4 5.8-4.4 1.6 0 3.1.2 4 .6"></path>
                    </svg>
                    
                    <span class="nhsuk-header__service-name">
                        Assurance Audit
                    </span>
              
            </a>
        </div>      

                   
        </div>  
                  
</header>



{% endblock %}

<!-- Footer goes inside the footer block -->
<!-- More info and code for the footer can be found at https://beta.nhs.uk/service-manual/styles-components-patterns/footer -->
{% block footer %}
<footer role="contentinfo">
    <div class="nhsuk-footer" id="nhsuk-footer">
        <div class="nhsuk-width-container">
            <h2 class="nhsuk-u-visually-hidden">Support links</h2>
            <ul class="nhsuk-footer__list">
                <li class="nhsuk-footer__list-item">
                    <a class="nhsuk-footer__list-item-link id-check_external-link" title="open sharepoint site in new tab" href="https://hscic365.sharepoint.com/sites/NHSloginIDVerify/SitePages/NHS-login-ID-Verification-Toolkit.aspx" target="_blank">ID checking guidance</a>
                </li>
            </ul>
        </div>
    </div>
</footer>
{% endblock %}


{% block content %}



<!-- 
    \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
    ------------------------          CSS STYLE OVERRIDES         --------------
    \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
-->


<style>

    .nhsuk-header
    {
        display: none;  
    }

    .nhsuk-header-audit-view
    {
        background-color: #ffff;
        color:black;
    }

    .nhsuk-header__navigation
    {
        background-color:transparent;
    }


    .tick
    {
        vertical-align: middle;
        margin-left: 2%;
    }

    .position-fixed
    {
        position:fixed;
    }

    .sticky
    {
        position:sticky;
        z-index: 999; 
        top:0%;
    }

    .sticky-child
    {
        position:sticky;
        top:64px;
    }

    .nhsuk-care-card__content-override
    {
        padding-bottom: 0px;
        padding-left: 24px;
        padding-right: 24px;
        background-color: transparent;
        border-top: 0;
        padding-top: 0px;
    }

    .nhsuk-care-card__content-override-2
    {
        padding-bottom: 0px;
        padding-left: 0px;
        padding-right: 24px;
        background-color:#f0f4f5;
        border-top: 0;
        padding-top: 32px;
    }

    .nhsuk-care-card__content-override-3
    {
        padding-bottom: 0px;
        padding-left: 24px;
        padding-right: 24px;
        background-color: #f0f4f5;
        border-top: 0;
        padding-top: 0px;
    }


    .border-line 
    {
        border-right: 1px solid #aeb7bd;
    }

    .top-margin-override
    {
        margin-top: 64px;
    }
    
    .idcheck-image-rotate-button 
    {
    position: absolute;
    display: block;
    width: 30px;
    height: 30px;
    background-position: 50% 50%;
    background-image: url('/assets/images/rotate-icon.png');
    background-size: 20px;
    background-repeat: no-repeat;
    z-index: 5;
    background-color: #fff;
    bottom: 10px;
    right: 10px;
    }

    

    
</style>

<!-- 
    \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
    ------------------------          JOURNEY TAGS         --------------
    \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
-->

<div class="sticky">
    <!-- is this automated? check for an absence of video file --> 
    {% if data.manual === 'true' %}
    <div class="id-check_uplift">Manual journey</div> 
    {% else %}
    <div class="id-check_automated" >Automated journey</div>
    {% endif %}
</div> 


<!--

$$$$$$$\  $$\   $$\  $$$$$$\ $$$$$$$$\  $$$$$$\         $$$$$$\  $$\   $$\ $$$$$$$$\  $$$$$$\  $$\   $$\
$$  __$$\ $$ |  $$ |$$  __$$\\__$$  __|$$  __$$\       $$  __$$\ $$ |  $$ |$$  _____|$$  __$$\ $$ | $$  |
$$ |  $$ |$$ |  $$ |$$ /  $$ |  $$ |   $$ /  $$ |      $$ /  \__|$$ |  $$ |$$ |      $$ /  \__|$$ |$$  /
$$$$$$$  |$$$$$$$$ |$$ |  $$ |  $$ |   $$ |  $$ |      $$ |      $$$$$$$$ |$$$$$\    $$ |      $$$$$  /
$$  ____/ $$  __$$ |$$ |  $$ |  $$ |   $$ |  $$ |      $$ |      $$  __$$ |$$  __|   $$ |      $$  $$<
$$ |      $$ |  $$ |$$ |  $$ |  $$ |   $$ |  $$ |      $$ |  $$\ $$ |  $$ |$$ |      $$ |  $$\ $$ |\$$\
$$ |      $$ |  $$ | $$$$$$  |  $$ |    $$$$$$  |      \$$$$$$  |$$ |  $$ |$$$$$$$$\ \$$$$$$  |$$ | \$$\
\__|      \__|  \__| \______/   \__|    \______/        \______/ \__|  \__|\________| \______/ \__|  \__|

-->


<!--\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\    LEFT COLUMN   /////////////////////////////////////////////////////////
            
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
-->

<div class="nhsuk-care-card nhsuk-care-card--non-urgent nhsuk-u-margin-bottom-0 nhsuk-u-margin-top-4 ">

    
    <div class="nhsuk-care-card__content-override">
        <div class="nhsuk-grid-row">

            <!--\\\\\\\\\\\\\\\\\\\\\\\\    LEFT COLUMN   //////////////////////////////////////////
            
            \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
            \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
            -->
               
                <div class="nhsuk-grid-column-one-half nhsuk-care-card__content-override  border-line sticky-child nhsuk-u-padding-top-4">
                    
                    
                    <div class="nhsuk-care-card__content">
                        <h3>Photo ID</h3>
                        <p class="nhsuk-body-s idcheck-help">To zoom in either double click on the picture, or position your cursor on the image, then hold 'Alt' + scroll with your mouse wheel. <a href="#" id="reset">Reset</a></p>
                        <div class="reading-width panzoom-parent idcheck-image-container">
        
                            <div class="idcheck-image-expand"><a href="#" class="idcheck-image-expand-button">Expand image</a></div>
        
                            <div class="idcheck-image zoomable1">
                                <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                                     alt="Picture of identity document"/>
                            </div>
        
                            {% if data.idv[data.prototype.count].media_photoid_back !== '' %}
        
                            <div class="reading-width idcheck-image-container">
                                <div class="idcheck-image-expand"><a href="#" class="idcheck-image-expand-button">Expand image</a></div>
                                <div class="idcheck-image zoomable2">
                                    <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_back}}" class="idcheck-image-img" style="width: 100%;" alt="Image of a driving licence"/>
                                </div>
                            </div>
        
                            {% endif %}
        
                        </div>
                    </div>
                    
                </div>
            
            <!--\\\\\\\\\\\\\\\\\\\\\\\\    RIGHT COLUMN   //////////////////////////////////////////
            
            \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
            \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
            -->

                <div class="nhsuk-grid-column-one-half  nhsuk-care-card__content-override ">
                    
                    <!--\\\\\\\\\\\\\\\\\\\\\\\\    USER SUBMITTED DATA   ////////////////////////////-->


                    <div class="nhsuk-form-group nhsuk-u-margin-bottom-7 nhsuk-u-padding-top-4">
                            <h3>User information</h3>
    
                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="nhsnum">
                                    NHS Number
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-10" id="nhsnum" value="9686883606" name="nhsnum" type="text" maxlength="10" readonly>
                            </div>

                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="firstname">
                                    First name
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="firstname" value="Joe" name="firstname" type="text" maxlength="" readonly >
                            </div>
                     
                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="middlename">
                                    Middle names
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="middlename" value="William" name="middlename" type="text" maxlength="" readonly >
                            </div>

                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="lastname">
                                    Last name
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-20" id="lastname" value="Boggs" name="lastname" type="text" maxlength="" readonly >
                            </div>


                            <div class="nhsuk-form-group">
                                <fieldset class="nhsuk-fieldset" aria-describedby="example-hint" role="group">
                                    <legend class="nhsuk-fieldset__legend">
                                        <h3 class="nhsuk-fieldset__legend">
                                            Date of birth
                                        </h3>
                                    </legend>
                                    <div class="nhsuk-date-input" id="example">
                                        <div class="nhsuk-date-input__item">
                                            <div class="nhsuk-form-group">
                                                <input class="nhsuk-input nhsuk-date-input__input nhsuk-input--width-2" id="example-day" name="example-day" type="number" value="{{ data.idv[data.prototype.count].date_day}}" readonly>
                                            </div>
                                        </div>
                                        <div class="nhsuk-date-input__item">
                                            <div class="nhsuk-form-group">
                                                <input class="nhsuk-input nhsuk-date-input__input nhsuk-input--width-2" id="example-month" name="example-month" type="number" value="{{ data.idv[data.prototype.count].date_month}}" readonly>
                                            </div>
                                        </div>
                                        <div class="nhsuk-date-input__item">
                                            <div class="nhsuk-form-group">
                                                <input class="nhsuk-input nhsuk-date-input__input nhsuk-input--width-4" id="example-year" name="example-year" type="number" value="{{ data.idv[data.prototype.count].date_year}}" readonly>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            

                            <div class="nhsuk-form-group">
                                <label class="nhsuk-label" for="postcode">
                                    Postcode
                                </label>
                                <input class="nhsuk-input nhsuk-input--width-5" id="postcode" value="{{ data.idv[data.prototype.count].postcode}}" name="postcode" type="text" maxlength="" readonly >
                            </div>


                        </div>

                    
                    <!--\\\\\\\\\\\\\\\\\\\\\\\\           PDS RECORD        ////////////////////////////////////////////////////////
                    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                    -->

                    <div class="nhsuk-u-margin-top-9 nhsuk-care-card__content">
                        <h3>PDS record</h3>

                        <div class="idcheck-match">

                            <table id="pds-result">
                                <tr>
                                    <td>First name:</td>
                                    <td><b>Joe</b></td>
                                </tr>
                                <tr>
                                    <td>Middle name:</td>
                                    <td><b>William</b></td>
                                </tr>
                                <tr>
                                    <td>Last name:</td>
                                    <td><b>Bloggs</b></td>
                                </tr>
                                <tr>
                                    <td>Date of birth:</td>
                                    <td><b>1st November, 1991</b></td>
                                </tr>
                                <tr>
                                    <td>NHS number:</td>
                                    <td><b>9686883606</b></td>
                                </tr>
                            </table>
        
                        </div>
                        
                    </div>

                    <!--\\\\\\\\\\\\\\\\\\\\\\\\             VIDEO           ////////////////////////////////////////////////////
                    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                    -->

                    <div class="nhsuk-u-margin-top-9 nhsuk-u-margin-bottom-9 nhsuk-care-card__content">

                        {% if data.manual === 'true' %}
                        <h3>Video selfie</h3>
                        {% else %}
                        <h3>Image from face scan</h3>
                        {% endif %}
                        <div class="idcheck-media">
                            


                                <img src="/images/media/scans/iproov-scan.png" class="idcheck-image-img" style="width: 100%; height: 100%;"
                                    alt="Image of the user from iproov"/>

                                
                        </div>

                        <div class="idcheck-divider">&nbsp;</div>

                        <div class="idcheck-image-container idcheck-photoid" style="display: none;">

                            <div class="idcheck-image zoomable4" >

                                <img src="/images/media/photos/{{ data.idv[data.prototype.count].media_photoid_front}}" class="idcheck-image-img" style="width: 100%;"
                                    alt="Picture of an identity document"/>

                            </div>

                        </div>

                    </div>
                    <br>
                                    

                    </div>
                </div>
            </div>


            
            
        </div>
    </div>

</div>

<!--

$$$$$$$\  $$$$$$$\   $$$$$$\        $$$$$$$$\ $$$$$$$\   $$$$$$\   $$$$$$\  $$$$$$$$\
$$  __$$\ $$  __$$\ $$  __$$\       \__$$  __|$$  __$$\ $$  __$$\ $$  __$$\ $$  _____|
$$ |  $$ |$$ |  $$ |$$ /  \__|         $$ |   $$ |  $$ |$$ /  $$ |$$ /  \__|$$ |
$$$$$$$  |$$ |  $$ |\$$$$$$\           $$ |   $$$$$$$  |$$$$$$$$ |$$ |      $$$$$\
$$  ____/ $$ |  $$ | \____$$\          $$ |   $$  __$$< $$  __$$ |$$ |      $$  __|
$$ |      $$ |  $$ |$$\   $$ |         $$ |   $$ |  $$ |$$ |  $$ |$$ |  $$\ $$ |
$$ |      $$$$$$$  |\$$$$$$  |         $$ |   $$ |  $$ |$$ |  $$ |\$$$$$$  |$$$$$$$$\
\__|      \_______/  \______/          \__|   \__|  \__|\__|  \__| \______/ \________|

-->




<!--

$$\       $$$$$$\ $$\   $$\ $$$$$$$$\ $$\   $$\ $$$$$$$$\  $$$$$$\   $$$$$$\              $$\       $$\       $$$$$$\ $$\    $$\ $$$$$$$$\ $$\   $$\ $$$$$$$$\  $$$$$$\   $$$$$$\
$$ |      \_$$  _|$$ | $$  |$$  _____|$$$\  $$ |$$  _____|$$  __$$\ $$  __$$\            $$  |      $$ |      \_$$  _|$$ |   $$ |$$  _____|$$$\  $$ |$$  _____|$$  __$$\ $$  __$$\
$$ |        $$ |  $$ |$$  / $$ |      $$$$\ $$ |$$ |      $$ /  \__|$$ /  \__|          $$  /       $$ |        $$ |  $$ |   $$ |$$ |      $$$$\ $$ |$$ |      $$ /  \__|$$ /  \__|
$$ |        $$ |  $$$$$  /  $$$$$\    $$ $$\$$ |$$$$$\    \$$$$$$\  \$$$$$$\           $$  /        $$ |        $$ |  \$$\  $$  |$$$$$\    $$ $$\$$ |$$$$$\    \$$$$$$\  \$$$$$$\
$$ |        $$ |  $$  $$<   $$  __|   $$ \$$$$ |$$  __|    \____$$\  \____$$\         $$  /         $$ |        $$ |   \$$\$$  / $$  __|   $$ \$$$$ |$$  __|    \____$$\  \____$$\
$$ |        $$ |  $$ |\$$\  $$ |      $$ |\$$$ |$$ |      $$\   $$ |$$\   $$ |       $$  /          $$ |        $$ |    \$$$  /  $$ |      $$ |\$$$ |$$ |      $$\   $$ |$$\   $$ |
$$$$$$$$\ $$$$$$\ $$ | \$$\ $$$$$$$$\ $$ | \$$ |$$$$$$$$\ \$$$$$$  |\$$$$$$  |      $$  /           $$$$$$$$\ $$$$$$\    \$  /   $$$$$$$$\ $$ | \$$ |$$$$$$$$\ \$$$$$$  |\$$$$$$  |
\________|\______|\__|  \__|\________|\__|  \__|\________| \______/  \______/       \__/            \________|\______|    \_/    \________|\__|  \__|\________| \______/  \______/

-->


<script type="text/javascript">
    /* eslint-disable indent */

    // hide or show the buttons based on selections
    // localStorage.removeItem("idchecker")
    addEventListeners()
    addButtonListeners()
    addClarityButtonListeners()
    addRejectionListeners()
    resetAllSections()
    addRetraceListener()
    addOtherListener()
    addSlideoutListener()
    questionsComplete = false

    // Change the trancoded button on click
{#             function change()
        {
            var elem = document.getElementById("transcodelink");
            if (elem.innerHTML=="Show the original video") elem.innerHTML = "Show the transcoded video";
            else elem.innerHTML = "Show the original video";
        } #}

{# var btn = document.getElementById("transcodelink");
btn.value = 'my value'; // will just add a hidden value
btn.innerHTML = 'my text'; #}


    function getParameterByName(name, url) {
        if (!url) url = window.location.href
        name = name.replace(/[\[\]]/g, "\\$&")
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url)
        if (!results) return null
        if (!results[2]) return ''
        return decodeURIComponent(results[2].replace(/\+/g, " "))
    }

    var state = getParameterByName('state')

    setTimeout(function () {
        document.getElementById('trace').style.display = 'block'
        // document.getElementById('retrybtn-1').style.display = 'block'
        if (state === 'noresult') {
            $('label[for="1"]').click()
        }
    }, 2000)
    setTimeout(function () {
        document.getElementById('loader').style.display = 'none'
    }, 2000)

    setTimeout(function () {
        document.getElementById('declinebtn-2').style.display = 'block'
        var errors = document.getElementsByClassName('idcheck-edit')
        for (i = 0; i < errors.length; i++) {
            errors[i].style.display = 'inline-block'
        }
        if (state === 'noresult') {
            $('label[for="1"]').click()
        }
    }, 2000)

    setTimeout(function () {
        document.getElementById('slideout-value_tab_spinner').style.display = 'none'
    }, 4000)

    setTimeout(function () {
        document.getElementById('slideout-value_tab_value').style.display = 'block'
    }, 4000)

    // when any radio button is clicked
    var processClick = function (e) {
        // update local storage straight away
        updateStorageFromElements()

        // first unset all the aria-checked attributes in an answer group
        var labels = e.parentNode.getElementsByClassName('qa-questions-answer')

        for (i = 0; i < labels.length; i++) {
            labels[i].setAttribute('aria-checked', false)
        }
        // then check only the selected one
        e.setAttribute('aria-checked', true)

        // a click will trigger the showing and hiding of question groups

        // get the section the click was in and pass it into a function
        var section = e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        checkSectionComplete(section)
    }

    // when an approve or decline button is clicked
    var buttonClick = function (object, event) {
        event.preventDefault()

        var target = object.parentElement.parentElement.getAttribute('data-group')

        var link = object.href
        var heading = document.getElementById('modal-header')

        var content = document.getElementById('modal_holder')
        content.classList.remove('modal-content--clarity')

        document.getElementById('modal-clarity').style.display = 'none'

        heading.innerText = 'Information about this declined verification'
        var a = document.getElementById('modal-link')
        a.href = link
        document.getElementById('modal_create').click()

        var buttonType = object.text

        if (buttonType === 'Decline') {
            console.log(target)
            if (target === 'decline-5') {
                heading.innerText = 'Select the reason for rejection'
            } else if (target === 'decline-0') {
                heading.innerText = 'Select the reason for rejection'
            } else if (target === 'decline-1') {
                heading.innerText = 'Which part of the ID is affected, and how?'
            } else if (target === 'decline-7') {
                heading.innerText = 'Select the reason for rejection'
            } else {
                heading.innerText = 'Select the reason for rejection'
            }
            setSubReasons('')
            setReasons(target)
            document.getElementById('modal_create').click()
        } else {
            heading.innerText = 'Information about this approved verification'
            document.getElementById('rejection-reasons').style.display = 'none'
        }
    }

    // when a don't know button is clicked
    var clarityClick = function (object, event) {
        event.preventDefault()

        var link = object.href
        var heading = document.getElementById('modal-header')

        var clarityQuestion = object.parentNode.getAttribute('id')

        console.log(clarityQuestion)

        if (clarityQuestion === 'id-canttell2') {
            heading.innerText = 'Select all the reasons you cannot answer this question'
        } else if (clarityQuestion === 'id-canttell3') {
            heading.innerText = 'Select the reason you cannot confirm whether it\'s a valid document (select all that apply)'
          document.getElementById('idcheck-clarity-hologram').style.display = 'block'
        } else if (clarityQuestion === 'selfie-2') {
            heading.innerText = 'Information about this declined verification (Faces do not match)'
        }

        var content = document.getElementById('modal_holder')
        content.classList.add('modal-content--clarity')

        document.getElementById('modal-link').removeAttribute('disabled')

        document.getElementById('modal-clarity').style.display = 'block'

        var rejections = document.getElementById('rejection-reasons')
        rejections.style.display = 'none'

        var a = document.getElementById('modal-link')
        a.href = link
        document.getElementById('modal_create').click()

        var buttonType = object.text
    }

    function setReasons(target) {
        // first do a reset
        console.log("set reasons")
        // get all the dropdowns into an array;
        document.getElementById('rejection-reasons').style.display = 'block'
        var reasons = document.getElementsByClassName('decline-group')
        for (i = 0; i < reasons.length; i++) {
            reasons[i].style.display = 'none'
            reasons[i].selectedIndex = "0";
        }
        if (target){
            document.getElementById(target).style.display = 'block'
        }
    }

    var selectChange = function (object, event) {
        var target = object.options[object.selectedIndex].getAttribute('data-question')
        setSubReasons(target)
    }

    function setSubReasons(target) {


        // reset everything before showing the picked one
        var subReasons = document.getElementById('rejection-text').getElementsByTagName('div')
        resetText()
        for (i = 0; i < subReasons.length; i++) {
            subReasons[i].style.display = 'none'
        }
        if (target){

          console.log(target)

            if (target === "decline-text-15" || target === "none" ) {
                document.getElementById('modal-link').removeAttribute("disabled")
              document.getElementById('rejection-text').style.display = 'none'
            } else {
                document.getElementById('rejection-text').style.display = 'block'

                if (target === "decline-text-16") {
                    console.log('hello')
                }
            }

            document.getElementById(target).style.display = 'block'
            // show the text area
            // document.getElementById('rejection-text').style.display = 'block'
        } else {
            document.getElementById('rejection-text').style.display = 'none'
        }
    }

    function checkText(text) {
        if(text.length >= 1) {
            document.getElementById('modal-link').removeAttribute("disabled")
        } else if(text.length == 0) {
            document.getElementById('modal-link').setAttribute("disabled", '')
        }
    }

    function resetText() {
        var textarea = document.getElementById('field3')
        textarea.value = ''
        document.getElementById('modal-link').setAttribute("disabled", '')
    }

    function retrace() {
        document.getElementById('trace').style.display = 'none'
        document.getElementById('declinebtn-2').style.display = 'none'
        document.getElementById('loader').style.display = 'block'
        setTimeout(function () {
            document.getElementById('retrace').style.display = 'block'
            document.getElementById('pds-retrace-result').style.display = 'block'
        }, 2000)
        setTimeout(function () {
            document.getElementById('loader').style.display = 'none'
            document.getElementById('pds-result').style.display = 'none'
        }, 2000)
    }

    // run through all sections checking for completeness
    function resetAllSections() {
        // get an array of all the question groups
        var questionGroups = document.getElementsByClassName('qa-questions-group')
        // lets hold the completion state of each section in an array
        for (i = 0; i < questionGroups.length; i++) {
            // reset attributes
            questionGroups[i].setAttribute('data-complete', false)
            // get array of all the answer groups
            var questions = questionGroups[i].getElementsByClassName('qa-questions-question')
            // loop through all the question groups
            for (j = 0; j < questions.length; j++) {
                // get array of the labels
                var answers = questionGroups[i].getElementsByClassName('qa-questions-answer')
                // loop through answers
                for (k = 0; k < answers.length; k++) {
                    answers[k].setAttribute('aria-checked', false)
                    // get the individual inputs
                    var inputs = answers[k].getElementsByTagName('input')
                    // loop through all the inputs and uncheck them
                    for (l = 0; l < answers.length; l++) {
                      // answers[l].checked = false
                      answers[l].disabled = true
                    }
                }
            }
        }
        unlockFirstQuestion()
    }



    function addEventListeners() {
        var inputs = document.getElementsByTagName('input')
        for (i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('click', function () {
                processClick(this)
            })
        }
    }

    function addButtonListeners() {
        var inputs = document.querySelectorAll('.button--decline')
        for (i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('click', function (event) {
                buttonClick(this, event)
            })
        }
    }

    function addClarityButtonListeners() {
        var inputs = document.querySelectorAll('.button--decline--clarity')
        for (i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('click', function (event) {
                clarityClick(this, event)
            })
        }
    }

    function addRejectionListeners() {
        var selects = document.querySelectorAll('.decline-group')
        for (i = 0; i < selects.length; i++) {
            selects[i].addEventListener('change', function (event) {
                selectChange(this, event)
            })
        }
    }

    function addOtherListener() {
        if (document.getElementById('example-hint-10')) {
            var selects = document.getElementById('example-hint-10')
            selects.addEventListener('change', function () {
                if(this.checked) {
                    // selectChange(this, event)
                    var target = this.getAttribute('data-question')
                    setSubReasons(target)
                } else {
                    var target = this.getAttribute('data-question')
                    setSubReasons(target)
                }
            })
        }
    }

    function addRetraceListener() {
        if (document.getElementById('retraceBtn')) {
            var selects = document.getElementById('retraceBtn')
            selects.addEventListener('click', function (event) {
                retrace(this, event)
            })
        }
    }

    function addSlideoutListener() {
        if (document.getElementById('slideout__button')) {
            var selects = document.getElementById('slideout__button')
            selects.addEventListener('click', function (event) {
                if (document.getElementById('slideout').getAttribute('data-status') === 'closed') {
                    console.log('slideout')
                    document.getElementById('slideout').setAttribute('data-status', 'open')
                    document.getElementById('slideout_inner').setAttribute('data-status', 'open')
                } else {
                    document.getElementById('slideout').setAttribute('data-status', 'closed')
                    document.getElementById('slideout_inner').setAttribute('data-status', 'closed')
                }
            })
        }
    }

    function updateStorageFromElements() {
        var idCheck = []
        var inputs = document.getElementsByTagName('input')
        for (i = 0; i < inputs.length; i++) {
            var inputId = inputs[i].getAttribute('id')
            idCheck[inputId] = inputs[i].checked
        }
        localStorage.setItem('idchecker', JSON.stringify(idCheck))
    }

    function checkSectionComplete(section) {
        // get an array of all the question subgroups
        var questions = section.getElementsByClassName('qa-questions-question')
        var sectionComplete = true
        for (i = 0; i < questions.length; i++) {
            var inputs = questions[i].getElementsByTagName('input')
            var questionComplete = false
            for (j = 0; j < inputs.length; j++) {
                if (inputs[j].checked) {
                    questionComplete = true
                }
            }
            if (false === questionComplete) {
                sectionComplete = false
            }
        }
        if (sectionComplete) {
            section.setAttribute('data-complete', true)
            unlockNextSection(section)
            return true
        }
    }

    function unlockNextSection(section) {
        var id = section.getElementsByClassName('qa-questions-question')[0].getAttribute('id')
        var sections = []
        var groups = document.getElementsByClassName('qa-questions-group')
        for (i = 0; i < groups.length; i++) {
            sections[i] = groups[i].getElementsByClassName('qa-questions-question')[0].getAttribute('id')
        }
        // work out what the next section is
        var currentSectionPosition = sections.indexOf(id)
        var nextSectionPosition = currentSectionPosition + 1
        var lastSection = sections[groups.length-1]

       console.log("unlock " + nextSectionPosition)
        // console.log(lastSection)

        if (currentSectionPosition < groups.length-1 ){
            var nextSection = sections[nextSectionPosition]
            // get the next section object
            nextSection = document.getElementById(nextSection)

            // enable radio buttons
            var nextRadios = nextSection.getElementsByTagName('input')

            // enable next clarity link
          if (document.getElementById(sections[nextSectionPosition]).parentNode.getElementsByClassName('button--decline--clarity')[0]) {
            console.log("clarity question exists in next section")
            document.getElementById(sections[nextSectionPosition]).parentNode.getElementsByClassName('button--decline--clarity')[0].classList.remove('disabled')
          }

            for (j = 0; j < nextRadios.length; j++) {
                nextRadios[j].disabled = false
            }
        }
        updateSolutions()
    }

    function updateSolutions() {
        // pull in the answer array
        var idCheck = JSON.parse(localStorage['idchecker'])

        if (idCheck[11] === true ) {
            document.getElementById('manual-pds-1').style.display = 'block'
            document.getElementById('radio-inline-3').disabled = false
            document.getElementById('radio-inline-4').disabled = false
        }
        else if (idCheck[10] === true ) {
            document.getElementById('manual-pds-1').style.display = 'none'
        }

        if (idCheck[13] === true ) {
            document.getElementById('manual-pds-2').style.display = 'block'
            document.getElementById('radio-inline-5').disabled = false
            document.getElementById('radio-inline-6').disabled = false
        }
        else if (idCheck[12] === true ) {
            document.getElementById('manual-pds-2').style.display = 'none'
        }

        if (idCheck[1] === true || idCheck[3] === true || idCheck[5] === true || idCheck[9] === true || idCheck[15] === true || idCheck[17] === true || idCheck[20] === true ) {

            console.log('something is off')
            if (document.getElementById('radio-inline-3') !== true ) {

                document.getElementById('approveBtn').style.display = 'none'
                document.getElementById('declineBtn').style.display = 'inline-block'

                // var declineButton = document.getElementById('id-decline')
                // document.getElementById('#document-1').append(declineButton)

                // document.getElementById('canttellBtn').style.display = 'none'

                if (idCheck[1] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('document-1').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[3] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('document-2').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[5] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('document-3').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[9] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('pds-1').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[15] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('selfie-1').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[17] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('selfie-2').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else if (idCheck[20] === true) {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('selfie-3').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                } else {
                    var declineButton = document.getElementById('id-decline')
                    document.getElementById('id-buttons').getElementsByClassName("nhsuk-fieldset")[0].after(declineButton)
                }
            }
        }

        else if (idCheck[0] === true && idCheck[2] === true && idCheck[4] === true && idCheck[8] === true && idCheck[10] === true && idCheck[12] === true && idCheck[14] === true && idCheck[16] === true && idCheck[19] === true) {

            console.log('yay all yes')
            document.getElementById('approveBtn').style.display = 'inline-block'
            document.getElementById('declineBtn').style.display = 'none'
            // document.getElementById('canttellBtn').style.display = 'none'
        }

        else if (idCheck[0] === true && idCheck[2] === true && idCheck[4] === true && idCheck[8] === true && idCheck['radio-inline-3'] === true && idCheck['radio-inline-4'] === true && idCheck[14] === true && idCheck[16] === true && idCheck[19] === true) {

            console.log('yay all yesses')
            document.getElementById('approveBtn').style.display = 'inline-block'
            document.getElementById('declineBtn').style.display = 'none'
            // document.getElementById('canttellBtn').style.display = 'none'
        }

        else {
            document.getElementById('approveBtn').style.display = 'none'
            document.getElementById('declineBtn').style.display = 'none'
            // document.getElementById('canttellBtn').style.display = 'none'
        }

    }

    function unlockFirstQuestion() {
        // console.log("unlock")

        // get an array of all the question groups
        var questionGroup1 = document.getElementById('document-1')
        var questionGroup2 = document.getElementById('document-2')
        var questionGroup3 = document.getElementById('document-3')
        //
        var inputs = questionGroup1.getElementsByTagName('input')
        // // loop through all the inputs and uncheck them
        for (l = 0; l < inputs.length; l++) {
            inputs[l].checked = false
            inputs[l].disabled = false
        }

        // check to see if document check has passed
        // If yes, then disable all the radios for the doc check section and select the

        if ({{ data.idv[data.prototype.count].doc_check_passes }}) {

            var inputs1 = questionGroup1.getElementsByTagName('input')
            var inputs2 = questionGroup2.getElementsByTagName('input')
            var inputs3 = questionGroup3.getElementsByTagName('input')
            for (m = 0; m < inputs1.length; m++) {
                inputs1[0].checked = false;
                // inputs1[m].disabled = true;
                inputs2[0].checked = false;
                inputs2[m].disabled = true;
                inputs3[0].checked = false;
                inputs3[m].disabled = true;
            }

            if ({{ data.idv[data.prototype.count].pds_matches }} === 'true') {
                console.log("unlock date of birth question")
                var questionGroup4 = document.getElementById('pds-1')
                var inputs4 = questionGroup4.getElementsByTagName('input')
                // // loop through all the inputs and uncheck them
                for (n = 0; n < inputs4.length; n++) {
                    inputs4[n].checked = false
                    inputs4[n].disabled = false
                }
            }else {
                console.log("unlock: can you find record question")
                var questionGroup5 = document.getElementById('trace-1')
                var inputs5 = questionGroup5.getElementsByTagName('input')
                // // loop through all the inputs and uncheck them
                for (n = 0; n < inputs5.length; n++) {
                    inputs5[n].checked = false
                    inputs5[n].disabled = false
                }
            }
        }
        // updateSolutions()
    }


</script>

{% endblock %}

{% block pageScripts %}
<script>
    const photo1 = document.querySelector('.zoomable1')
    const photo2 = document.querySelector('.zoomable2')
    const photo3 = document.querySelector('.zoomable3')
    const photo4 = document.querySelector('.zoomable4')
    const photo5 = document.querySelector('.zoomable5')

    let area1 = panzoom(photo1, {
        smoothScroll: false,
        bounds: true,
        boundsPadding: 0.75,
        minZoom: 1,
        maxZoom: 5,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        }
    })

    // NEED IF STATEMENT HERE IF BACK IMAGE EXISTS

    // let area2 = panzoom(photo2, {
    //     smoothScroll: false,
    //     beforeWheel: function(e) {
    //         // allow wheel-zoom only if altKey is down. Otherwise - ignore
    //         var shouldIgnore = !e.altKey
    //         return shouldIgnore
    //     }
    // })
    let area3 = panzoom(photo3, {
        smoothScroll: false,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        },
        bounds: true,
        boundsPadding: 0.75,
        minZoom: 1,
        maxZoom: 5
    })
    let area4 = panzoom(photo4, {
        smoothScroll: false,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        },
        bounds: true,
        boundsPadding: 0.75,
        minZoom: 1,
        maxZoom: 5,
        transformOrigin: {x: 0.5, y: 0.5}
    })
    let area5 = panzoom(photo5, {
        smoothScroll: false,
        bounds: true,
        boundsPadding: 0.75,
        beforeWheel: function(e) {
            // allow wheel-zoom only if altKey is down. Otherwise - ignore
            var shouldIgnore = !e.altKey
            return shouldIgnore
        },
        minZoom: 1,
        maxZoom: 5
    })

    var reset = document.getElementById('reset')
    reset.addEventListener('click', function (event) {
        console.log('clicked')
        area1.zoomTo(1, 1, 0)
        area1.moveTo(0, 0)

        // document.getElementsByClassName('zoomable1')[0].style.transform = 'matrix(1, 0, 0, 1, 0, 0)'
        console.log(document.getElementsByClassName('zoomable1')[0])
    })


</script>
{% endblock %}
